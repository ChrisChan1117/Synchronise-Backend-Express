!function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(b){return 0==b?0:b>0?1:-1});var U={subtract:function(d,c){return{x:d.x-c.x,y:d.y-c.y}},dotProduct:function(d,c){return d.x*c.x+d.y*c.y},square:function(b){return Math.sqrt(b.x*b.x+b.y*b.y)},scale:function(d,c){return{x:d.x*c,y:d.y*c}}},T=64,S=Math.pow(2,-T-1),R=function(x,w){for(var v=[],u=P(x,w),t=w.length-1,s=2*t-1,r=O(u,s,v,0),q=U.subtract(x,w[0]),l=U.square(q),g=0,f=0;r>f;f++){q=U.subtract(x,K(w,t,v[f],null,null));var a=U.square(q);l>a&&(l=a,g=v[f])}return q=U.subtract(x,w[t]),a=U.square(q),l>a&&(l=a,g=1),{location:g,distance:l}},Q=function(e,d){var f=R(e,d);return{point:K(d,d.length-1,f.location,null,null),location:f.location}},P=function(ae,ad){for(var ac=ad.length-1,ab=2*ac-1,aa=[],Z=[],Y=[],X=[],W=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]],V=0;ac>=V;V++){aa[V]=U.subtract(ad[V],ae)}for(var V=0;ac-1>=V;V++){Z[V]=U.subtract(ad[V+1],ad[V]),Z[V]=U.scale(Z[V],3)}for(var x=0;ac-1>=x;x++){for(var w=0;ac>=w;w++){Y[x]||(Y[x]=[]),Y[x][w]=U.dotProduct(Z[x],aa[w])}}for(V=0;ab>=V;V++){X[V]||(X[V]=[]),X[V].y=0,X[V].x=parseFloat(V)/ab}for(var v=ac,u=ac-1,t=0;v+u>=t;t++){var a=Math.max(0,t-u),af=Math.min(t,v);for(V=a;af>=V;V++){j=t-V,X[V+j].y+=Y[j][V]*W[j][V]}}return X},O=function(v,u,t,s){var r,l,k=[],i=[],h=[],g=[];switch(N(v,u)){case 0:return 0;case 1:if(s>=T){return t[0]=(v[0].x+v[u].x)/2,1}if(M(v,u)){return t[0]=L(v,u),1}}K(v,u,0.5,k,i),r=O(k,u,h,s+1),l=O(i,u,g,s+1);for(var b=0;r>b;b++){t[b]=h[b]}for(var b=0;l>b;b++){t[b+r]=g[b]}return r+l},N=function(h,g){var m,l,k=0;m=l=Math.sgn(h[0].y);for(var i=1;g>=i;i++){m=Math.sgn(h[i].y),m!=l&&k++,l=m}return k},M=function(am,al){var ak,aj,ai,ah,ag,af,ae,ad,ac,ab,aa,Z,Y,X,W,V;af=am[0].y-am[al].y,ae=am[al].x-am[0].x,ad=am[0].x*am[al].y-am[al].x*am[0].y;for(var x=max_distance_below=0,w=1;al>w;w++){var c=af*am[w].x+ae*am[w].y+ad;c>x?x=c:max_distance_below>c&&(max_distance_below=c)}return aa=0,Z=1,Y=0,X=af,W=ae,V=ad-x,ac=aa*W-X*Z,ab=1/ac,aj=(Z*V-W*Y)*ab,X=af,W=ae,V=ad-max_distance_below,ac=aa*W-X*Z,ab=1/ac,ai=(Z*V-W*Y)*ab,ah=Math.min(aj,ai),ag=Math.max(aj,ai),ak=ag-ah,S>ak?1:0},L=function(v,u){var t=1,s=0,r=v[u].x-v[0].x,q=v[u].y-v[0].y,p=v[0].x-0,o=v[0].y-0,n=r*s-q*t,m=1/n,l=(r*o-q*p)*m;return 0+t*l},K=function(k,i,q,p,o){for(var n=[[]],m=0;i>=m;m++){n[0][m]=k[m]}for(var l=1;i>=l;l++){for(var m=0;i-l>=m;m++){n[l]||(n[l]=[]),n[l][m]||(n[l][m]={}),n[l][m].x=(1-q)*n[l-1][m].x+q*n[l-1][m+1].x,n[l][m].y=(1-q)*n[l-1][m].y+q*n[l-1][m+1].y}}if(null!=p){for(m=0;i>=m;m++){p[m]=n[m][0]}}if(null!=o){for(m=0;i>=m;m++){o[m]=n[i-m][m]}}return n[i][0]},J={},I=function(v){var u=J[v];if(!u){u=[];var t=function(){return function(a){return Math.pow(a,v)}},s=function(){return function(a){return Math.pow(1-a,v)}},r=function(b){return function(){return b}},q=function(){return function(b){return b}},p=function(){return function(b){return 1-b}},o=function(b){return function(a){for(var f=1,e=0;e<b.length;e++){f*=b[e](a)}return f}};u.push(new t);for(var n=1;v>n;n++){for(var m=[new r(v)],l=0;v-n>l;l++){m.push(new q)}for(var l=0;n>l;l++){m.push(new p)}u.push(new o(m))}u.push(new s),J[v]=u}return u},H=function(h,g){for(var m=I(h.length-1),l=0,k=0,i=0;i<h.length;i++){l+=h[i].x*m[i](g),k+=h[i].y*m[i](g)}return{x:l,y:k}},G=function(d,c){return Math.sqrt(Math.pow(d.x-c.x,2)+Math.pow(d.y-c.y,2))},F=function(b){return b[0].x==b[1].x&&b[0].y==b[1].y},E=function(k,i,q){if(F(k)){return{point:k[0],location:i}}for(var p=H(k,i),o=0,n=i,m=q>0?1:-1,l=null;o<Math.abs(q);){n+=0.005*m,l=H(k,n),o+=G(l,p),p=l}return{point:l,location:n}},D=function(h){if(F(h)){return 0}for(var g=H(h,0),m=0,l=0,k=1,i=null;1>l;){l+=0.005*k,i=H(h,l),m+=G(i,g),g=i}return m},C=function(e,d,f){return E(e,d,f).point},B=function(e,d,f){return E(e,d,f).location},A=function(h,g){var m=H(h,g),l=H(h.slice(0,h.length-1),g),k=l.y-m.y,i=l.x-m.x;return 0==k?1/0:Math.atan(k/i)},z=function(f,e,h){var g=E(f,e,h);return g.location>1&&(g.location=1),g.location<0&&(g.location=0),A(f,g.location)},y=function(s,r,q,p){p=null==p?0:p;var o=E(s,r,p),n=A(s,o.location),m=Math.atan(-1/n),l=q/2*Math.sin(m),k=q/2*Math.cos(m);return[{x:o.point.x+k,y:o.point.y+l},{x:o.point.x-k,y:o.point.y-l}]};window.jsBezier={distanceFromCurve:R,gradientAtPoint:A,gradientAtPointAlongCurveFrom:z,nearestPointOnCurve:Q,pointOnCurve:H,pointAlongCurveFrom:C,perpendicularToCurveAt:y,locationAlongCurveFrom:B,getLength:D}}(),function(){var i=this.Biltong={},h=function(b){return"[object Array]"===Object.prototype.toString.call(b)},o=function(b,f,e){return b=h(b)?b:[b.x,b.y],f=h(f)?f:[f.x,f.y],e(b,f)},n=i.gradient=function(d,c){return o(d,c,function(f,e){return e[0]==f[0]?e[1]>f[1]?1/0:-1/0:e[1]==f[1]?e[0]>f[0]?0:-0:(e[1]-f[1])/(e[0]-f[0])})},m=(i.normal=function(d,c){return -1/n(d,c)},i.lineLength=function(d,c){return o(d,c,function(f,e){return Math.sqrt(Math.pow(e[1]-f[1],2)+Math.pow(e[0]-f[0],2))})},i.quadrant=function(d,c){return o(d,c,function(f,e){return e[0]>f[0]?e[1]>f[1]?2:1:e[0]==f[0]?e[1]>f[1]?2:1:e[1]>f[1]?3:4})}),l=(i.theta=function(d,c){return o(d,c,function(p,e){var s=n(p,e),r=Math.atan(s),q=m(p,e);return(4==q||3==q)&&(r+=Math.PI),0>r&&(r+=2*Math.PI),r})},i.intersects=function(y,x){var w=y.x,v=y.x+y.w,u=y.y,t=y.y+y.h,s=x.x,r=x.x+x.w,q=x.y,p=x.y+x.h;return s>=w&&v>=s&&q>=u&&t>=q||r>=w&&v>=r&&q>=u&&t>=q||s>=w&&v>=s&&p>=u&&t>=p||r>=w&&v>=s&&p>=u&&t>=p||w>=s&&r>=w&&u>=q&&p>=u||v>=s&&r>=v&&u>=q&&p>=u||w>=s&&r>=w&&t>=q&&p>=t||v>=s&&r>=w&&t>=q&&p>=t},i.encloses=function(A,z,y){var x=A.x,w=A.x+A.w,v=A.y,u=A.y+A.h,t=z.x,s=z.x+z.w,r=z.y,q=z.y+z.h,p=function(f,c,B,g){return y?c>=f&&B>=g:c>f&&B>g};return p(x,t,w,s)&&p(v,r,u,q)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),k=[null,[-1,-1],[-1,1],[1,1],[1,-1]];i.pointOnLine=function(t,s,r){var q=n(t,s),p=m(t,s),g=r>0?l[p]:k[p],f=Math.atan(q),e=Math.abs(r*Math.sin(f))*g[1],d=Math.abs(r*Math.cos(f))*g[0];return{x:t.x+d,y:t.y+e}},i.perpendicularLineTo=function(p,d,u){var t=n(p,d),s=Math.atan(-1/t),r=u/2*Math.sin(s),q=u/2*Math.cos(s);return[{x:d.x+q,y:d.y+r},{x:d.x-q,y:d.y-r}]}}.call(this),function(){var aj={android:navigator.userAgent.toLowerCase().indexOf("android")>-1},ai=function(g,f,k){k=k||g.parentNode;for(var i=k.querySelectorAll(f),h=0;h<i.length;h++){if(i[h]===g){return !0}}return !1},ah=function(b){return"string"==typeof b?document.getElementById(b):b},ag=function(b){return b.srcElement||b.target},af=function(f,e){for(var h=0,g=f.length;g>h&&f[h]!=e;h++){}h<f.length&&f.splice(h,1)},ae=1,ad=function(f,e,h){var g=ae++;return f.__ta=f.__ta||{},f.__ta[e]=f.__ta[e]||{},f.__ta[e][g]=h,h.__tauid=g,g},ac=function(f,e,h){if(f.__ta&&f.__ta[e]&&delete f.__ta[e][h.__tauid],h.__taExtra){for(var g=0;g<h.__taExtra.length;g++){N(f,h.__taExtra[g][0],h.__taExtra[g][1])}h.__taExtra.length=0}h.__taUnstore&&h.__taUnstore()},ab=function(b,m,l,k){if(null==b){return l}var i=b.split(","),d=function(c){d.__tauid=l.__tauid;for(var g=ag(c),e=0;e<i.length;e++){ai(g,i[e],m)&&l.apply(g,arguments)}};return aa(l,k,d),d},aa=function(e,d,f){e.__taExtra=e.__taExtra||[],e.__taExtra.push([d,f])},Z=function(f,e,h,g){S&&O[e]?P(f,O[e],ab(g,f,h,O[e]),h):P(f,e,ab(g,f,h,e),h)},Y=function(e,d,o,n){if(null==e.__taSmartClicks){var m=function(a){e.__tad=I(a)},l=function(a){e.__tau=I(a)},k=function(a){if(e.__tad&&e.__tau&&e.__tad[0]===e.__tau[0]&&e.__tad[1]===e.__tau[1]){for(var f=0;f<e.__taSmartClicks.length;f++){e.__taSmartClicks[f].apply(ag(a),[a])}}};Z(e,"mousedown",m,n),Z(e,"mouseup",l,n),Z(e,"click",k,n),e.__taSmartClicks=[]}e.__taSmartClicks.push(o),o.__taUnstore=function(){af(e.__taSmartClicks,o)}},X={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},W=function(b,d){return function(t,s,r,q){if("contextmenu"==s&&Q){Z(t,s,r,q)}else{if(null==t.__taTapHandler){var m=t.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},k=function(i){for(var h=i.srcElement||i.target,f=0;f<m.downSelectors.length;f++){if(null==m.downSelectors[f]||ai(h,m.downSelectors[f],t)){m.down=!0,setTimeout(c,b),setTimeout(a,d);break}}},e=function(f){if(m.down){var u=f.srcElement||f.target;m.taps++;var p=R(f);for(var o in X){var n=X[o];if(n.touches===p&&(1===n.taps||n.taps===m.taps)){for(var l=0;l<m[o].length;l++){(null==m[o][l][1]||ai(u,m[o][l][1],t))&&m[o][l][0].apply(ag(f),[f])}}}}},c=function(){m.down=!1},a=function(){m.taps=0};Z(t,"mousedown",k),Z(t,"mouseup",e)}t.__taTapHandler.downSelectors.push(q),t.__taTapHandler[s].push([r,q]),r.__taUnstore=function(){af(t.__taTapHandler[s],r)}}}},V=function(g,f,k,i){for(var h in k.__tamee[g]){k.__tamee[g][h].apply(i,[f])}},U=function(){var b=[];return function(m,l,i,g){if(!m.__tamee){m.__tamee={over:!1,mouseenter:[],mouseexit:[]};var d=function(h){var c=ag(h);(null==g&&c==m&&!m.__tamee.over||ai(c,g,m)&&(null==c.__tamee||!c.__tamee.over))&&(V("mouseenter",h,m,c),c.__tamee=c.__tamee||{},c.__tamee.over=!0,b.push(c))},a=function(k){for(var h=ag(k),c=0;c<b.length;c++){h!=b[c]||ai(k.relatedTarget||k.toElement,"*",h)||(h.__tamee.over=!1,b.splice(c,1),V("mouseexit",k,m,h))}};P(m,"mouseover",ab(g,m,d,"mouseover"),d),P(m,"mouseout",ab(g,m,a,"mouseout"),a)}i.__taUnstore=function(){delete m.__tamee[l][i.__tauid]},ad(m,l,i),m.__tamee[l][i.__tauid]=i}},S="ontouchstart" in document.documentElement,Q="onmousedown" in document.documentElement,O={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},M=function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var d=navigator.userAgent,f=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=f.exec(d)&&(e=parseFloat(RegExp.$1))}return e}(),K=M>-1&&9>M,J=function(f,e){if(null==f){return[0,0]}var h=T(f),g=F(h,0);return[g[e+"X"],g[e+"Y"]]},I=function(b){return null==b?[0,0]:K?[b.clientX+document.documentElement.scrollLeft,b.clientY+document.documentElement.scrollTop]:J(b,"page")},H=function(b){return J(b,"screen")},G=function(b){return J(b,"client")},F=function(d,c){return d.item?d.item(c):d[c]},T=function(b){return b.touches&&b.touches.length>0?b.touches:b.changedTouches&&b.changedTouches.length>0?b.changedTouches:b.targetTouches&&b.targetTouches.length>0?b.targetTouches:[b]},R=function(b){return T(b).length},P=function(g,f,k,i){if(ad(g,f,k),i.__tauid=k.__tauid,g.addEventListener){g.addEventListener(f,k,!1)}else{if(g.attachEvent){var h=f+k.__tauid;g["e"+h]=k,g[h]=function(){g["e"+h]&&g["e"+h](window.event)},g.attachEvent("on"+f,g[h])}}},N=function(e,c,f){null!=f&&L(e,function(){var b=ah(this);if(ac(b,c,f),null!=f.__tauid){if(b.removeEventListener){b.removeEventListener(c,f,!1)}else{if(this.detachEvent){var d=c+f.__tauid;b[d]&&b.detachEvent("on"+c,b[d]),b[d]=null,b["e"+d]=null}}}})},L=function(e,d){if(null!=e){e="string"!=typeof e&&null==e.tagName&&null!=e.length?e:"string"==typeof e?document.querySelectorAll(e):[e];for(var f=0;f<e.length;f++){d.apply(e[f])}}};this.Mottle=function(a){a=a||{};var o=a.clickThreshold||150,n=a.dblClickThreshold||350,m=new U,l=new W(o,n),k=a.smartClicks,c=function(g,f,i,h){null!=i&&L(g,function(){var b=ah(this);k&&"click"===f?Y(b,f,i,h):"tap"===f||"dbltap"===f||"contextmenu"===f?l(b,f,i,h):"mouseenter"===f||"mouseexit"==f?m(b,f,i,h):Z(b,f,i,h)})};this.remove=function(b){return L(b,function(){var f=ah(this);if(f.__ta){for(var e in f.__ta){for(var g in f.__ta[e]){N(f,e,f.__ta[e][g])}}}f.parentNode&&f.parentNode.removeChild(f)}),this},this.on=function(){var f=arguments[0],e=4==arguments.length?arguments[2]:null,h=arguments[1],g=arguments[arguments.length-1];return c(f,h,g,e),this},this.off=function(e,d,f){return N(e,d,f),this},this.trigger=function(p,w,v,u){var t=S&&O[w]?O[w]:w,s=I(v),r=H(v),q=G(v);return L(p,function(){var e,g=ah(this);v=v||{screenX:r[0],screenY:r[1],clientX:q[0],clientY:q[1]};var f=function(b){u&&(b.payload=u)},d={TouchEvent:function(y){var x=document.createTouch(window,g,0,s[0],s[1],r[0],r[1],q[0],q[1],0,0,0,0);y.initTouchEvent(t,!0,!0,window,0,r[0],r[1],q[0],q[1],!1,!1,!1,!1,document.createTouchList(x))},MouseEvents:function(x){if(x.initMouseEvent(t,!0,!0,window,0,r[0],r[1],q[0],q[1],!1,!1,!1,!1,1,g),aj.android){var y=document.createTouch(window,g,0,s[0],s[1],r[0],r[1],q[0],q[1],0,0,0,0);x.touches=x.targetTouches=x.changedTouches=document.createTouchList(y)}}};if(document.createEvent){var i=S&&O[w]&&!aj.android,h=i?"TouchEvent":"MouseEvents";e=document.createEvent(h),d[h](e),f(e),g.dispatchEvent(e)}else{document.createEventObject&&(e=document.createEventObject(),e.eventType=e.eventName=t,e.screenX=r[0],e.screenY=r[1],e.clientX=q[0],e.clientY=q[1],f(e),g.fireEvent("on"+t,e))}}),this}},Mottle.consume=function(d,c){d.stopPropagation?d.stopPropagation():d.returnValue=!1,!c&&d.preventDefault&&d.preventDefault()},Mottle.pageLocation=I}.call(this),function(){var v=function(b){return"[object Array]"===Object.prototype.toString.call(b)},u=function(b){return"[object Number]"===Object.prototype.toString.call(b)},t=function(b){return"string"==typeof b},s=function(b){return"boolean"==typeof b},r=function(b){return null==b},q=function(b){return null==b?!1:"[object Object]"===Object.prototype.toString.call(b)},p=function(b){return"[object Date]"===Object.prototype.toString.call(b)},o=function(b){return"[object Function]"===Object.prototype.toString.call(b)},n=function(d){for(var c in d){if(d.hasOwnProperty(c)){return !1}}return !0},m=this,l=m.jsPlumbUtil={isArray:v,isString:t,isBoolean:s,isNull:r,isObject:q,isDate:p,isFunction:o,isEmpty:n,isNumber:u,clone:function(a){if(t(a)){return""+a}if(s(a)){return !!a}if(p(a)){return new Date(a.getTime())}if(o(a)){return a}if(v(a)){for(var g=[],f=0;f<a.length;f++){g.push(this.clone(a[f]))}return g}if(q(a)){var d={};for(var c in a){d[c]=this.clone(a[c])}return d}return a},merge:function(a,z,y){var x,w,f={};for(y=y||[],w=0;w<y.length;w++){f[y[w]]=!0}var d=this.clone(a);for(w in z){if(null==d[w]){d[w]=z[w]}else{if(t(z[w])||s(z[w])){f[w]?(x=[],x.push.apply(x,v(d[w])?d[w]:[d[w]]),x.push.apply(x,v(z[w])?z[w]:[z[w]]),d[w]=x):d[w]=z[w]}else{if(v(z[w])){x=[],v(d[w])&&x.push.apply(x,d[w]),x.push.apply(x,z[w]),d[w]=x}else{if(q(z[w])){q(d[w])||(d[w]={});for(var c in z[w]){d[w][c]=z[w][c]}}}}}}return d},replace:function(g,f,k){if(null!=g){var i=g,h=i;return f.replace(/([^\.])+/g,function(e,c,B,A){var z=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),y=B+e.length>=A.length,x=function(){return h[z[1]]||function(){return h[z[1]]=[],h[z[1]]}()};if(y){z?x()[z[3]]=k:h[e]=k}else{if(z){var w=x();h=w[z[3]]||function(){return w[z[3]]={},w[z[3]]}()}else{h=h[e]||function(){return h[e]={},h[e]}()}}}),g}},functionChain:function(g,f,k){for(var i=0;i<k.length;i++){var h=k[i][0][k[i][1]].apply(k[i][0],k[i][2]);if(h===f){return h}}return g},populate:function(a,h){var f=function(g){var d=g.match(/(\${.*?})/g);if(null!=d){for(var k=0;k<d.length;k++){var i=h[d[k].substring(2,d[k].length-1)]||"";null!=i&&(g=g.replace(d[k],i))}}return g},c=function(e){if(null!=e){if(t(e)){return f(e)}if(v(e)){for(var x=[],w=0;w<e.length;w++){x.push(c(e[w]))}return x}if(q(e)){var k={};for(var g in e){k[g]=c(e[g])}return k}return e}};return c(a)},convertStyle:function(i,h){if("transparent"===i){return i}var z=i,y=function(b){return 1==b.length?"0"+b:b},x=function(b){return y(Number(b).toString(16))},w=/(rgb[a]?\()(.*)(\))/;if(i.match(w)){var k=i.match(w)[2].split(",");z="#"+x(k[0])+x(k[1])+x(k[2]),h||4!=k.length||(z+=x(k[3]))}return z},findWithFunction:function(e,d){if(e){for(var f=0;f<e.length;f++){if(d(e[f])){return f}}}return -1},indexOf:function(d,c){return d.indexOf?d.indexOf(c):l.findWithFunction(d,function(b){return b==c})},removeWithFunction:function(e,d){var f=l.findWithFunction(e,d);return f>-1&&e.splice(f,1),-1!=f},remove:function(e,d){var f=l.indexOf(e,d);return f>-1&&e.splice(f,1),-1!=f},addWithFunction:function(e,d,f){-1==l.findWithFunction(e,f)&&e.push(d)},addToList:function(g,f,k,i){var h=g[f];return null==h&&(h=[],g[f]=h),h[i?"unshift":"push"](k),h},extend:function(a,x){var w;for(x=v(x)?x:[x],w=0;w<x.length;w++){for(var k in x[w].prototype){x[w].prototype.hasOwnProperty(k)&&(a.prototype[k]=x[w].prototype[k])}}var i=function(d,c){return function(){for(w=0;w<x.length;w++){x[w].prototype[d]&&x[w].prototype[d].apply(this,arguments)}return c.apply(this,arguments)}},h=function(b){for(var d in b){a.prototype[d]=i(d,b[d])}};if(arguments.length>2){for(w=2;w<arguments.length;w++){h(arguments[w])}}return a},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=0|16*Math.random(),f="x"==e?d:8|3&d;return f.toString(16)})},logEnabled:!0,log:function(){if(l.logEnabled&&"undefined"!=typeof console){try{var d=arguments[arguments.length-1];console.log(d)}catch(c){}}},wrap:function(e,d,f){return e=e||function(){},d=d||function(){},function(){var b=null;try{b=d.apply(this,arguments)}catch(a){l.log("jsPlumb function failed : "+a)}if(null==f||b!==f){try{b=e.apply(this,arguments)}catch(a){l.log("wrapped function failed : "+a)}}return b}}};l.EventGenerator=function(){var e={},d=!1,f={ready:!0};this.bind=function(a,h,g){return l.addToList(e,a,h,g),this},this.fire=function(z,y,x){if(!d&&e[z]){var w=e[z].length,k=0,c=!1,b=null;if(!this.shouldFireEvent||this.shouldFireEvent(z,y,x)){for(;!c&&w>k&&b!==!1;){if(f[z]){e[z][k].apply(this,[y,x])}else{try{b=e[z][k].apply(this,[y,x])}catch(a){l.log("jsPlumb: fire failed for event "+z+" : "+a)}}k++,(null==e||null==e[z])&&(c=!0)}}}return this},this.unbind=function(a){return a?delete e[a]:e={},this},this.getListener=function(a){return e[a]},this.setSuspendEvents=function(b){d=b},this.isSuspendEvents=function(){return d},this.cleanupListeners=function(){for(var a in e){e[a]=null}}},l.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}},Function.prototype.bind||(Function.prototype.bind=function(g){if("function"!=typeof this){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var f=Array.prototype.slice.call(arguments,1),k=this,i=function(){},h=function(){return k.apply(this instanceof i&&g?this:g,f.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,h.prototype=new i,h})}.call(this),function(){var d=this,c=d.jsPlumbUtil;c.ieVersion=/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1,c.oldIE=c.ieVersion>-1&&c.ieVersion<9,c.matchesSelector=function(g,f,k){k=k||g.parentNode;for(var i=k.querySelectorAll(f),h=0;h<i.length;h++){if(i[h]===g){return !0}}return !1},c.consume=function(f,e){f.stopPropagation?f.stopPropagation():f.returnValue=!1,!e&&f.preventDefault&&f.preventDefault()},c.sizeElement=function(g,f,k,i,h){g&&(g.style.height=h+"px",g.height=h,g.style.width=i+"px",g.width=i,g.style.left=f+"px",g.style.top=k+"px")}}.call(this),function(){var H=this,G=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),F=function(){if(void 0===F.vml){var d=document.body.appendChild(document.createElement("div"));d.innerHTML='<v:shape id="vml_flag1" adj="1" />';var c=d.firstChild;null!=c&&null!=c.style?(c.style.behavior="url(#default#VML)",F.vml=c?"object"==typeof c.adj:!0):F.vml=!1,d.parentNode.removeChild(d)}return F.vml},E=function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var d=navigator.userAgent,f=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=f.exec(d)&&(e=parseFloat(RegExp.$1))}return e}(),D=E>-1&&9>E,C=function(f,e){if(null==f){return[0,0]}var h=x(f),g=y(h,0);return[g[e+"X"],g[e+"Y"]]},B=function(b){return null==b?[0,0]:D?[b.clientX+document.documentElement.scrollLeft,b.clientY+document.documentElement.scrollTop]:C(b,"page")},A=function(b){return C(b,"screen")},z=function(b){return C(b,"client")},y=function(d,c){return d.item?d.item(c):d[c]},x=function(b){return b.touches&&b.touches.length>0?b.touches:b.changedTouches&&b.changedTouches.length>0?b.changedTouches:b.targetTouches&&b.targetTouches.length>0?b.targetTouches:[b]},w=function(h){var g={},m=[],l={},k={},i={};this.register=function(d){var c=h.getId(d),b=jsPlumbAdapter.getOffset(d,h);g[c]||(g[c]=d,m.push(d),l[c]={});var a=function(e){if(e){for(var p=0;p<e.childNodes.length;p++){if(3!=e.childNodes[p].nodeType&&8!=e.childNodes[p].nodeType){var o=jsPlumb.getElementObject(e.childNodes[p]),n=h.getId(e.childNodes[p],null,!0);if(n&&k[n]&&k[n]>0){var f=jsPlumbAdapter.getOffset(o,h);l[c][n]={id:n,offset:{left:f.left-b.left,top:f.top-b.top}},i[n]=c}a(e.childNodes[p])}}}};a(d)},this.updateOffsets=function(a){if(null!=a){var I=jsPlumb.getDOMElement(a),q=h.getId(I),p=l[q],o=jsPlumbAdapter.getOffset(I,h);if(p){for(var n in p){var f=jsPlumb.getElementObject(n),d=jsPlumbAdapter.getOffset(f,h);l[q][n]={id:n,offset:{left:d.left-o.left,top:d.top-o.top}},i[n]=q}}}},this.endpointAdded=function(o,n){n=n||h.getId(o);var f=document.body,e=o.parentNode;for(k[n]=k[n]?k[n]+1:1;null!=e&&e!=f;){var d=h.getId(e,null,!0);if(d&&g[d]){var b=jsPlumbAdapter.getOffset(e,h);if(null==l[d][n]){var a=jsPlumbAdapter.getOffset(o,h);l[d][n]={id:n,offset:{left:a.left-b.left,top:a.top-b.top}},i[n]=d}break}e=e.parentNode}},this.endpointDeleted=function(d){if(k[d.elementId]&&(k[d.elementId]--,k[d.elementId]<=0)){for(var c in l){l[c]&&(delete l[c][d.elementId],delete i[d.elementId])}}},this.changeId=function(d,c){l[c]=l[d],l[d]={},i[c]=i[d],i[d]=null},this.getElementsForDraggable=function(b){return l[b]},this.elementRemoved=function(d){var c=i[d];c&&(delete l[c][d],delete i[d])},this.reset=function(){g={},m=[],l={},k={}},this.dragEnded=function(a){var f=h.getId(a),e=i[f];e&&this.updateOffsets(e)},this.setParent=function(a,q,p,o){var n=i[q];if(n){l[o]||(l[o]={}),l[o][q]=l[n][q],delete l[n][q];var f=jsPlumbAdapter.getOffset(p,h),d=jsPlumbAdapter.getOffset(a,h);l[o][q].offset={left:d.left-f.left,top:d.top-f.top},i[q]=o}},this.getDragAncestor=function(a){var o=jsPlumb.getDOMElement(a),n=h.getId(o),f=i[n];return f?jsPlumb.getDOMElement(f):null}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}});var v=function(b){return null==b?null:b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},u=function(d,c){c=v(c),"undefined"!=typeof d.className.baseVal?d.className.baseVal=c:d.className=c},t=function(b){return"undefined"==typeof b.className.baseVal?b.className:b.className.baseVal},s=function(h,g,m){g=null==g?[]:jsPlumbUtil.isArray(g)?g:g.split(/\s+/),m=null==m?[]:jsPlumbUtil.isArray(m)?m:m.split(/\s+/);var l=t(h),k=l.split(/\s+/),i=function(f,e){for(var o=0;o<e.length;o++){if(f){-1==jsPlumbUtil.indexOf(k,e[o])&&k.push(e[o])}else{var n=jsPlumbUtil.indexOf(k,e[o]);-1!=n&&k.splice(n,1)}}};i(!0,g),i(!1,m),u(h,k.join(" "))},r=function(e,d){if(null!=e){if("string"==typeof e){d(jsPlumb.getDOMElement(e))}else{if(null!=e.length){for(var f=0;f<e.length;f++){d(jsPlumb.getDOMElement(e[f]))}}else{d(e)}}}};window.jsPlumbAdapter={headless:!1,pageLocation:B,screenLocation:A,clientLocation:z,getAttribute:function(d,c){return d.getAttribute(c)},setAttribute:function(e,d,f){e.setAttribute(d,f)},appendToRoot:function(b){document.body.appendChild(b)},getRenderModes:function(){return["svg","vml"]},isRenderModeAvailable:function(b){return{svg:G,vml:F()}[b]},getDragManager:function(b){return new w(b)},setRenderMode:function(f){var e;if(f){f=f.toLowerCase();var h=this.isRenderModeAvailable("svg"),g=this.isRenderModeAvailable("vml");"svg"===f?h?e="svg":g&&(e="vml"):g&&(e="vml")}return e},addClass:function(d,c){r(d,function(b){s(b,c)})},hasClass:function(d,c){return d=jsPlumb.getDOMElement(d),d.classList?d.classList.contains(c):-1!=t(d).indexOf(c)},removeClass:function(d,c){r(d,function(b){s(b,null,c)})},updateClasses:function(e,d,f){r(e,function(b){s(b,d,f)})},setClass:function(d,c){r(d,function(b){u(b,c)})},setPosition:function(d,c){d.style.left=c.left+"px",d.style.top=c.top+"px"},getPosition:function(d){var c=function(a){var e=d.style[a];return e?e.substring(0,e.length-2):0};return{left:c("left"),top:c("top")}},getOffset:function(i,h,o){i=jsPlumb.getDOMElement(i);for(var n=h.getContainer(),m=i.offsetLeft,l=i.offsetTop,k=o||null!=n&&i.offsetParent!=n?i.offsetParent:null;null!=k;){m+=k.offsetLeft,l+=k.offsetTop,k=o?k.offsetParent:k.offsetParent==n?null:k.offsetParent}return{left:m,top:l}},getPositionOnElement:function(aa,Z,Y){var X="undefined"!=typeof Z.getBoundingClientRect?Z.getBoundingClientRect():{left:0,top:0,width:0,height:0},W=document.body,V=document.documentElement,U=(Z.offsetParent,window.pageYOffset||V.scrollTop||W.scrollTop),T=window.pageXOffset||V.scrollLeft||W.scrollLeft,S=V.clientTop||W.clientTop||0,R=V.clientLeft||W.clientLeft||0,Q=0,P=0,O=X.top+U-S+Q*Y,N=X.left+T-R+P*Y,M=jsPlumbAdapter.pageLocation(aa),L=X.width||Z.offsetWidth*Y,K=X.height||Z.offsetHeight*Y,J=(M[0]-N)/L,I=(M[1]-O)/K;return[J,I]},getAbsolutePosition:function(d){var c=function(a){var e=d.style[a];return e?parseFloat(e.substring(0,e.length-2)):void 0};return[c("left"),c("top")]},setAbsolutePosition:function(a,h,g,f){g?H.jsPlumb.animate(a,{left:"+="+(h[0]-g[0]),top:"+="+(h[1]-g[1])},f):(a.style.left=h[0]+"px",a.style.top=h[1]+"px")}}}.call(this),function(){var N=jsPlumbUtil,M=function(e,d,f){return jsPlumbAdapter.getOffset(e,d,f)},L=function(){return""+(new Date).getTime()},K=function(d){if(d._jsPlumb.paintStyle&&d._jsPlumb.hoverPaintStyle){var c={};u.extend(c,d._jsPlumb.paintStyle),u.extend(c,d._jsPlumb.hoverPaintStyle),delete d._jsPlumb.hoverPaintStyle,c.gradient&&d._jsPlumb.paintStyle.fillStyle&&delete c.gradient,d._jsPlumb.hoverPaintStyle=c}},J=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],I=function(i,h,o,n){var m=i.getAttachedElements();if(m){for(var l=0,k=m.length;k>l;l++){n&&n==m[l]||m[l].setHover(h,!0,o)}}},H=function(b){return null==b?null:b.split(" ")},G=function(a,o,n){if(a.getDefaultType){for(var m=a.getTypeDescriptor(),l=N.merge({},a.getDefaultType()),k=0,i=a._jsPlumb.types.length;i>k;k++){l=N.merge(l,a._jsPlumb.instance.getType(a._jsPlumb.types[k],m),["cssClass"])}o&&(l=N.populate(l,o)),a.applyType(l,n),n||a.repaint()}},F=window.jsPlumbUIComponent=function(a){jsPlumbUtil.EventGenerator.apply(this,arguments);var o=this,n=arguments,m=o.idPrefix,l=m+(new Date).getTime();if(this._jsPlumb={instance:a._jsPlumb,parameters:a.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:a.beforeDetach,beforeDrop:a.beforeDrop,overlayPlacements:[],hoverClass:a.hoverClass||a._jsPlumb.Defaults.HoverClass,types:[]},this.getId=function(){return l},a.events){for(var k in a.events){o.bind(k,a.events[k])}}this.clone=function(){var b={};return this.constructor.apply(b,n),b}.bind(this),this.isDetachAllowed=function(e){var g=!0;if(this._jsPlumb.beforeDetach){try{g=this._jsPlumb.beforeDetach(e)}catch(f){N.log("jsPlumb: beforeDetach callback failed",f)}}return g},this.isDropAllowed=function(R,Q,P,O,t,s,r){var q=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:R,targetId:Q,scope:P,connection:O,dropEndpoint:t,source:s,target:r});if(this._jsPlumb.beforeDrop){try{q=this._jsPlumb.beforeDrop({sourceId:R,targetId:Q,scope:P,connection:O,dropEndpoint:t,source:s,target:r})}catch(p){N.log("jsPlumb: beforeDrop callback failed",p)}}return q};var i=[];this.setListenerComponent=function(d){for(var c=0;c<i.length;c++){i[c][3]=d}}},E=function(f,e){var h=f._jsPlumb.types[e],g=f._jsPlumb.instance.getType(h,f.getTypeDescriptor());null!=g&&g.cssClass&&f.canvas&&f._jsPlumb.instance.removeClass(f.canvas,g.cssClass)};jsPlumbUtil.extend(F,jsPlumbUtil.EventGenerator,{getParameter:function(b){return this._jsPlumb.parameters[b]},setParameter:function(d,c){this._jsPlumb.parameters[d]=c},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(b){this._jsPlumb.parameters=b},addClass:function(b){jsPlumbAdapter.addClass(this.canvas,b)},removeClass:function(b){jsPlumbAdapter.removeClass(this.canvas,b)},updateClasses:function(d,c){jsPlumbAdapter.updateClasses(this.canvas,d,c)},setType:function(e,d,f){this.clearTypes(),this._jsPlumb.types=H(e)||[],G(this,d,f)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(d,c){G(this,d,c)},hasType:function(b){return -1!=jsPlumbUtil.indexOf(this._jsPlumb.types,b)},addType:function(h,g,o){var n=H(h),m=!1;if(null!=n){for(var l=0,k=n.length;k>l;l++){this.hasType(n[l])||(this._jsPlumb.types.push(n[l]),m=!0)}m&&G(this,g,o)}},removeType:function(a,o){var n=H(a),m=!1,l=function(d){var e=N.indexOf(this._jsPlumb.types,d);return -1!=e?(E(this,e),this._jsPlumb.types.splice(e,1),!0):!1}.bind(this);if(null!=n){for(var h=0,g=n.length;g>h;h++){m=l(n[h])||m}m&&G(this,null,o)}},clearTypes:function(e){for(var d=this._jsPlumb.types.length,f=0;d>f;f++){E(this,0),this._jsPlumb.types.splice(0,1)}G(this,{},e)},toggleType:function(h,g,o){var n=H(h);if(null!=n){for(var m=0,l=n.length;l>m;m++){var k=jsPlumbUtil.indexOf(this._jsPlumb.types,n[m]);-1!=k?(E(this,k),this._jsPlumb.types.splice(k,1)):this._jsPlumb.types.push(n[m])}G(this,g,o)}},applyType:function(e,d){if(this.setPaintStyle(e.paintStyle,d),this.setHoverPaintStyle(e.hoverPaintStyle,d),e.parameters){for(var f in e.parameters){this.setParameter(f,e.parameters[f])}}},setPaintStyle:function(d,c){this._jsPlumb.paintStyle=d,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,K(this),c||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(d,c){this._jsPlumb.hoverPaintStyle=d,K(this),c||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(){this.cleanupListeners(),this.clone=null,this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(f,c,h){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){if(this._jsPlumb.hover=f,null!=this.canvas){if(null!=this._jsPlumb.instance.hoverClass){var g=f?"addClass":"removeClass";this._jsPlumb.instance[g](this.canvas,this._jsPlumb.instance.hoverClass)}null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[g](this.canvas,this._jsPlumb.hoverClass)}null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=f?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(h=h||L(),this.repaint({timestamp:h,recalc:!1}))),this.getAttachedElements&&!c&&I(this,f,L(),this)}}});var D="__label",C=function(g,f){for(var k=-1,i=0,h=g._jsPlumb.overlays.length;h>i;i++){if(f===g._jsPlumb.overlays[i].id){k=i;break}}return k},B=function(f,e){var h={cssClass:e.cssClass,labelStyle:f.labelStyle,id:D,component:f,_jsPlumb:f._jsPlumb.instance},g=u.extend(h,e);return new (u.Overlays[f._jsPlumb.instance.getRenderMode()].Label)(g)},A=function(a,k){var i=null;if(N.isArray(k)){var h=k[0],g=u.extend({component:a,_jsPlumb:a._jsPlumb.instance},k[1]);3==k.length&&u.extend(g,k[2]),i=new (u.Overlays[a._jsPlumb.instance.getRenderMode()][h])(g)}else{i=k.constructor==String?new (u.Overlays[a._jsPlumb.instance.getRenderMode()][k])({component:a,_jsPlumb:a._jsPlumb.instance}):k}a._jsPlumb.overlays.push(i)},z=function(i,h){var o=i.defaultOverlayKeys||[],n=h.overlays,m=function(a){return i._jsPlumb.instance.Defaults[a]||u.Defaults[a]||[]};n||(n=[]);for(var l=0,k=o.length;k>l;l++){n.unshift.apply(n,m(o[l]))}return n},y=window.OverlayCapableJsPlumbUIComponent=function(h){F.apply(this,arguments),this._jsPlumb.overlays=[];var g=z(this,h);if(g){for(var m=0,l=g.length;l>m;m++){A(this,g[m])}}if(h.label){var k=h.labelLocation||this.defaultLabelLocation||0.5,i=h.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle;this._jsPlumb.overlays.push(B(this,{label:h.label,location:k,labelStyle:i}))}this.setListenerComponent=function(d){if(this._jsPlumb){for(var c=0;c<this._jsPlumb.overlays.length;c++){this._jsPlumb.overlays[c].setListenerComponent(d)}}}};jsPlumbUtil.extend(y,F,{applyType:function(f,e){if(this.removeAllOverlays(e),f.overlays){for(var h=0,g=f.overlays.length;g>h;h++){this.addOverlay(f.overlays[h],!0)}}},setHover:function(e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){for(var d=0,f=this._jsPlumb.overlays.length;f>d;d++){this._jsPlumb.overlays[d][e?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)}}},addOverlay:function(d,c){A(this,d),c||this.repaint()},getOverlay:function(d){var c=C(this,d);return c>=0?this._jsPlumb.overlays[c]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(d){var c=this.getOverlay(d);c&&c.hide()},hideOverlays:function(){for(var d=0,c=this._jsPlumb.overlays.length;c>d;d++){this._jsPlumb.overlays[d].hide()}},showOverlay:function(d){var c=this.getOverlay(d);c&&c.show()},showOverlays:function(){for(var d=0,c=this._jsPlumb.overlays.length;c>d;d++){this._jsPlumb.overlays[d].show()}},removeAllOverlays:function(e){for(var d=0,f=this._jsPlumb.overlays.length;f>d;d++){this._jsPlumb.overlays[d].cleanup&&this._jsPlumb.overlays[d].cleanup()}this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length),this._jsPlumb.overlayPositions=null,e||this.repaint()},removeOverlay:function(e){var d=C(this,e);if(-1!=d){var f=this._jsPlumb.overlays[d];f.cleanup&&f.cleanup(),this._jsPlumb.overlays.splice(d,1),this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[e]}},removeOverlays:function(){for(var d=0,c=arguments.length;c>d;d++){this.removeOverlay(arguments[d])}},moveParent:function(d){this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),d.appendChild(this.bgCanvas)),this.canvas.parentNode.removeChild(this.canvas),d.appendChild(this.canvas);for(var c=0;c<this._jsPlumb.overlays.length;c++){this._jsPlumb.overlays[c].isAppendedAtTopLevel&&(this._jsPlumb.overlays[c].canvas.parentNode.removeChild(this._jsPlumb.overlays[c].canvas),d.appendChild(this._jsPlumb.overlays[c].canvas))}},getLabel:function(){var b=this.getOverlay(D);return null!=b?b.getLabel():null},getLabelOverlay:function(){return this.getOverlay(D)},setLabel:function(e){var d=this.getOverlay(D);if(d){e.constructor==String||e.constructor==Function?d.setLabel(e):(e.label&&d.setLabel(e.label),e.location&&d.setLocation(e.location))}else{var f=e.constructor==String||e.constructor==Function?{label:e}:e;d=B(this,f),this._jsPlumb.overlays.push(d)}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var b=0;b<this._jsPlumb.overlays.length;b++){this._jsPlumb.overlays[b].cleanup(),this._jsPlumb.overlays[b].destroy()}this._jsPlumb.overlays.length=0,this._jsPlumb.overlayPositions=null},setVisible:function(b){this[b?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(d,c){this._jsPlumb.overlayPositions=this._jsPlumb.overlayPositions||{},this._jsPlumb.overlayPositions[d.id]=c},getAbsoluteOverlayPosition:function(b){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[b.id]:null}});var x=0,w=function(){var b=x+1;return x++,b},v=window.jsPlumbInstance=function(az){this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:4,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},az&&u.extend(this.Defaults,az),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},jsPlumbUtil.EventGenerator.apply(this);var ax=this,aw=w(),av=ax.bind,at={},ar=1,aq=function(f){var d=ax.getDOMElement(f);return{el:d,id:jsPlumbUtil.isString(f)&&null==d?f:aE(d)}};this.getInstanceIndex=function(){return aw},this.setZoom=function(f,d){return jsPlumbUtil.oldIE||(ar=f,ax.fire("zoom",ar),d&&ax.repaintEverything()),!jsPlumbUtil.oldIE},this.getZoom=function(){return ar};for(var ap in this.Defaults){at[ap]=this.Defaults[ap]}var ao;this.setContainer=function(g){g=this.getDOMElement(g),this.select().each(function(d){d.moveParent(g)}),this.selectEndpoints().each(function(d){d.moveParent(g)}),ao=g;for(var f=function(m,l){var o=l.srcElement||l.target,n=(o&&o.parentNode?o.parentNode._jsPlumb:null)||(o?o._jsPlumb:null)||(o&&o.parentNode&&o.parentNode.parentNode?o.parentNode.parentNode._jsPlumb:null);n&&(n.fire(m,n,l),ax.fire(m,n,l))},k=function(d){ax.on(ao,d,"._jsPlumb_connector, ._jsPlumb_connector > *",function(l){f(d,l)}),ax.on(ao,d,"._jsPlumb_endpoint, ._jsPlumb_endpoint > *, ._jsPlumb_endpoint svg *",function(l){f(d,l)}),ax.on(ao,d,"._jsPlumb_overlay, ._jsPlumb_overlay *",function(l){f(d,l)})},h=0;h<J.length;h++){k(J[h])}},this.getContainer=function(){return ao},this.bind=function(f,d){"ready"===f&&al?d():av.apply(ax,[f,d])},ax.importDefaults=function(f){for(var d in f){ax.Defaults[d]=f[d]}return f.Container&&ax.setContainer(f.Container),ax},ax.restoreDefaults=function(){return ax.Defaults=u.extend({},at),ax};var am=null,al=!1,ak=[],aj={},ai={},ah={},ag={},af={},ae={},ad=!1,a4=[],a3=!1,a2=null,a1=this.Defaults.Scope,a0=null,aY=1,aX=function(){return""+aY++},aW=function(f,d){ao?ao.appendChild(f):d?this.getDOMElement(d).appendChild(f):this.appendToRoot(f)}.bind(this),aV=function(O,s,q,p){if(!jsPlumbAdapter.headless&&!a3){var o=aE(O),n=ax.dragManager.getElementsForDraggable(o);null==q&&(q=L());var m=a5({elId:o,offset:s,recalc:!1,timestamp:q});if(n){for(var l in n){a5({elId:n[l].id,offset:{left:m.o.left+n[l].offset.left,top:m.o.top+n[l].offset.top},recalc:!1,timestamp:q})}}if(ax.anchorManager.redraw(o,s,q,null,p),n){for(var f in n){ax.anchorManager.redraw(n[f].id,s,q,n[f].offset,p,!0)}}}},aU=function(f,q){var p,o,n,m=null;if(N.isArray(f)){m=[];for(var l=0,k=f.length;k>l;l++){p=ax.getElementObject(f[l]),n=ax.getDOMElement(p),o=ax.getAttribute(n,"id"),m.push(q.apply(ax,[n,o]))}}else{p=ax.getDOMElement(f),o=ax.getId(p),m=q.apply(ax,[p,o])}return m},aS=function(d){return ai[d]},aR=function(bb,ab,Z,Y){if(!jsPlumbAdapter.headless){var X=null==ab?!1:ab;if(X&&u.isDragSupported(bb,ax)&&!u.isAlreadyDraggable(bb,ax)){var W=Z||ax.Defaults.DragOptions;W=u.extend({},W);var V=u.dragEvents.drag,U=u.dragEvents.stop,T=u.dragEvents.start,S=ax.getDOMElement(bb),R=ax.dragManager.getDragAncestor(S),Q={left:0,top:0},P=Q,O=!1;bi(Y,bb),W[T]=N.wrap(W[T],function(){return P=null!=R?jsPlumbAdapter.getOffset(R,ax):Q,ax.setHoverSuspended(!0),ax.select({source:bb}).addClass(ax.elementDraggingClass+" "+ax.sourceElementDraggingClass,!0),ax.select({target:bb}).addClass(ax.elementDraggingClass+" "+ax.targetElementDraggingClass,!0),ax.setConnectionBeingDragged(!0),W.canDrag?Z.canDrag():void 0},!1),W[V]=N.wrap(W[V],function(){var d=ax.getUIPosition(arguments,ax.getZoom());d.left+=P.left,d.top+=P.top,aV(bb,d,null,!0),O&&ax.addClass(bb,"jsPlumb_dragged"),O=!0}),W[U]=N.wrap(W[U],function(){var d=ax.getUIPosition(arguments,ax.getZoom(),!0);aV(bb,d),O=!1,ax.removeClass(bb,"jsPlumb_dragged"),ax.setHoverSuspended(!1),ax.select({source:bb}).removeClass(ax.elementDraggingClass+" "+ax.sourceElementDraggingClass,!0),ax.select({target:bb}).removeClass(ax.elementDraggingClass+" "+ax.targetElementDraggingClass,!0),ax.setConnectionBeingDragged(!1),ax.dragManager.dragEnded(bb)});var s=aE(bb);ae[s]=!0;var f=ae[s];W.disabled=null==f?!1:!f,ax.initDraggable(bb,W),ax.dragManager.register(bb)}}},aQ=function(h,g){for(var n=h.scope.split(/\s/),m=g.scope.split(/\s/),l=0;l<n.length;l++){for(var k=0;k<m.length;k++){if(m[k]==n[l]){return !0}}}return !1},aP=function(f,q){var p=u.extend({},f);if(q&&u.extend(p,q),p.source&&(p.source.endpoint?p.sourceEndpoint=p.source:p.source=ax.getDOMElement(p.source)),p.target&&(p.target.endpoint?p.targetEndpoint=p.target:p.target=ax.getDOMElement(p.target)),f.uuids&&(p.sourceEndpoint=aS(f.uuids[0]),p.targetEndpoint=aS(f.uuids[1])),p.sourceEndpoint&&p.sourceEndpoint.isFull()){return N.log(ax,"could not add connection; source endpoint is full"),void 0}if(p.targetEndpoint&&p.targetEndpoint.isFull()){return N.log(ax,"could not add connection; target endpoint is full"),void 0}if(!p.type&&p.sourceEndpoint&&(p.type=p.sourceEndpoint.connectionType),p.sourceEndpoint&&p.sourceEndpoint.connectorOverlays){p.overlays=p.overlays||[];for(var o=0,n=p.sourceEndpoint.connectorOverlays.length;n>o;o++){p.overlays.push(p.sourceEndpoint.connectorOverlays[o])}}!p["pointer-events"]&&p.sourceEndpoint&&p.sourceEndpoint.connectorPointerEvents&&(p["pointer-events"]=p.sourceEndpoint.connectorPointerEvents);var m=function(h,g){var O=u.extend({},h);for(var s in g){g[s]&&(O[s]=g[s])}return O},l=function(g,d,h){return ax.addEndpoint(g,m(d,{anchor:p.anchors?p.anchors[h]:p.anchor,endpoint:p.endpoints?p.endpoints[h]:p.endpoint,paintStyle:p.endpointStyles?p.endpointStyles[h]:p.endpointStyle,hoverPaintStyle:p.endpointHoverStyles?p.endpointHoverStyles[h]:p.endpointHoverStyle}))},k=function(h,d,Q){if(p[h]&&!p[h].endpoint&&!p[h+"Endpoint"]&&!p.newConnection){var P=aE(p[h]),O=Q[P];if(O){if(!O.enabled){return !1}var s=null!=O.endpoint&&O.endpoint._jsPlumb?O.endpoint:l(p[h],O.def,d);if(O.uniqueEndpoint&&(O.endpoint=s),s.isFull()){return !1}p[h+"Endpoint"]=s,s._doNotDeleteOnDetach=!1,s._deleteOnDetach=!0}}};return k("source",0,this.sourceEndpointDefinitions)!==!1&&k("target",1,this.targetEndpointDefinitions)!==!1?(p.sourceEndpoint&&p.targetEndpoint&&(aQ(p.sourceEndpoint,p.targetEndpoint)||(p=null)),p):void 0}.bind(ax),aO=function(f){var d=ax.Defaults.ConnectionType||ax.getDefaultConnectionType();f._jsPlumb=ax,f.newConnection=aO,f.newEndpoint=aL,f.endpointsByUUID=ai,f.endpointsByElement=aj,f.finaliseConnection=aN;var g=new d(f);return g.id="con_"+aX(),g.isDetachable()&&(g.endpoints[0].initDraggable(),g.endpoints[1].initDraggable()),g},aN=ax.finaliseConnection=function(g,f,l,k){if(f=f||{},g.suspendedEndpoint||ak.push(g),g.endpoints[0].isTemporarySource=!1,(null==g.suspendedEndpoint||k)&&ax.anchorManager.newConnection(g),aV(g.source),!f.doNotFireConnectionEvent&&f.fireEvent!==!1){var h={connection:g,source:g.source,target:g.target,sourceId:g.sourceId,targetId:g.targetId,sourceEndpoint:g.endpoints[0],targetEndpoint:g.endpoints[1]};ax.fire("connection",h,l)}},aL=function(g,f){var l=ax.Defaults.EndpointType||u.Endpoint,k=u.extend({},g);k._jsPlumb=ax,k.newConnection=aO,k.newEndpoint=aL,k.endpointsByUUID=ai,k.endpointsByElement=aj,k.fireDetachEvent=bc,k.elementId=f||aE(k.source);var h=new l(k);return h.id="ep_"+aX(),bi(k.elementId,k.source),jsPlumbAdapter.headless||ax.dragManager.endpointAdded(k.source,f),h},aK=function(O,s,q){var p=aj[O];if(p&&p.length){for(var o=0,n=p.length;n>o;o++){for(var m=0,l=p[o].connections.length;l>m;m++){var k=s(p[o].connections[m]);if(k){return}}q&&q(p[o])}}},aJ=function(f,d){return aU(f,function(g,h){ae[h]=d,this.isDragSupported(g)&&this.setElementDraggable(g,d)})},aI=function(g,f,l){f="block"===f;var k=null;l&&(k=f?function(d){d.setVisible(!0,!0,!0)}:function(d){d.setVisible(!1,!0,!0)});var h=aq(g);aK(h.id,function(m){if(f&&l){var n=m.sourceId===h.id?1:0;m.endpoints[n].isVisible()&&m.setVisible(!0)}else{m.setVisible(f)}},k)},aH=function(d){return aU(d,function(g,f){var h=null==ae[f]?!1:ae[f];return h=!h,ae[f]=h,this.setDraggable(g,h),h}.bind(this))},aG=function(f,d){var g=null;d&&(g=function(k){var h=k.isVisible();k.setVisible(!h)}),aK(f,function(k){var h=k.isVisible();k.setVisible(!h)},g)},aF=function(f){var d=ag[f];return d?{o:d,s:a4[f]}:a5({elId:f})},aE=function(g,f,k){if(jsPlumbUtil.isString(g)){return g}if(null==g){return null}var h=ax.getAttribute(g,"id");return h&&"undefined"!==h||(2==arguments.length&&void 0!==arguments[1]?h=f:(1==arguments.length||3==arguments.length&&!arguments[2])&&(h="jsPlumb_"+aw+"_"+aX()),k||ax.setAttribute(g,"id",h)),h};this.setConnectionBeingDragged=function(d){ad=d},this.isConnectionBeingDragged=function(){return ad},this.connectorClass="_jsPlumb_connector",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.hoverSourceClass="_jsPlumb_source_hover",this.hoverTargetClass="_jsPlumb_target_hover",this.dragSelectClass="_jsPlumb_drag_select",this.Anchors={},this.Connectors={svg:{},vml:{}},this.Endpoints={svg:{},vml:{}},this.Overlays={svg:{},vml:{}},this.ConnectorRenderers={},this.SVG="svg",this.VML="vml",this.addEndpoint=function(S,R,Q){Q=Q||{};var P=u.extend({},Q);u.extend(P,R),P.endpoint=P.endpoint||ax.Defaults.Endpoint,P.paintStyle=P.paintStyle||ax.Defaults.EndpointStyle;for(var O=[],s=N.isArray(S)||null!=S.length&&!N.isString(S)?S:[S],q=0,p=s.length;p>q;q++){P.source=ax.getDOMElement(s[q]),aa(P.source);var o=aE(P.source),n=aL(P,o),f=bi(o,P.source).info.o;N.addToList(aj,o,n),a3||n.paint({anchorLoc:n.anchor.compute({xy:[f.left,f.top],wh:a4[o],element:n,timestamp:a2}),timestamp:a2}),O.push(n),n._doNotDeleteOnDetach=!0}return 1==O.length?O[0]:O},this.addEndpoints=function(f,p,o){for(var n=[],m=0,l=p.length;l>m;m++){var k=ax.addEndpoint(f,p[m],o);N.isArray(k)?Array.prototype.push.apply(n,k):n.push(k)}return n},this.animate=function(f,q,p){p=p||{};var o=ax.getElementObject(f),n=ax.getDOMElement(f),m=aE(n),l=u.animEvents.step,k=u.animEvents.complete;p[l]=N.wrap(p[l],function(){ax.revalidate(m)}),p[k]=N.wrap(p[k],function(){ax.revalidate(m)}),ax.doAnimate(o,q,p)},this.checkCondition=function(f,p){var o=ax.getListener(f),n=!0;if(o&&o.length>0){try{for(var m=0,l=o.length;l>m;m++){n=n&&o[m](p)}}catch(k){N.log(ax,"cannot check condition ["+f+"]"+k)}}return n},this.connect=function(g,f){var k,h=aP(g,f);if(h){if(null==h.source&&null==h.sourceEndpoint){return jsPlumbUtil.log("Cannot establish connection - source does not exist"),void 0}if(null==h.target&&null==h.targetEndpoint){return jsPlumbUtil.log("Cannot establish connection - target does not exist"),void 0}aa(h.source),k=aO(h),aN(k,h)}return k};var aD=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],aC=function(R,Q,P,O){var s,q,p,o=aD[P],n=R[o.elId],m=(R[o.el],R.endpoints[P]),l={index:P,originalSourceId:0===P?n:R.sourceId,newSourceId:R.sourceId,originalTargetId:1==P?n:R.targetId,newTargetId:R.targetId,connection:R};if(Q.constructor==u.Endpoint){s=Q,s.addConnection(R)}else{if(q=aE(Q),p=this[o.epDefs][q],q===R[o.elId]){s=null}else{if(p){if(!p.enabled){return}s=null!=p.endpoint&&p.endpoint._jsPlumb?p.endpoint:this.addEndpoint(Q,p.def),p.uniqueEndpoint&&(p.endpoint=s),s._doNotDeleteOnDetach=!1,s._deleteOnDetach=!0,s.addConnection(R)}else{s=R.makeEndpoint(0===P,Q,q),s._doNotDeleteOnDetach=!1,s._deleteOnDetach=!0}}}return null!=s&&(m.detachFromConnection(R),R.endpoints[P]=s,R[o.el]=s.element,R[o.elId]=s.elementId,l[0===P?"newSourceId":"newTargetId"]=s.elementId,aB(l),O||R.repaint()),l}.bind(this);this.setSource=function(g,f,k){var h=aC(g,f,0,k);this.anchorManager.sourceChanged(h.originalSourceId,h.newSourceId,g)},this.setTarget=function(g,f,k){var h=aC(g,f,1,k);this.anchorManager.updateOtherEndpoint(h.originalSourceId,h.originalTargetId,h.newTargetId,g)},this.deleteEndpoint=function(f,d){var g="string"==typeof f?ai[f]:f;return g&&ax.deleteObject({endpoint:g,dontUpdateHover:d}),ax},this.deleteEveryEndpoint=function(){var g=ax.setSuspendDrawing(!0);for(var f in aj){var l=aj[f];if(l&&l.length){for(var k=0,h=l.length;h>k;k++){ax.deleteEndpoint(l[k],!0)}}}return aj={},ah={},ai={},ax.anchorManager.reset(),ax.dragManager.reset(),g||ax.setSuspendDrawing(!1),ax};var bc=function(h,f,n){var m=ax.Defaults.ConnectionType||ax.getDefaultConnectionType(),l=h.constructor==m,k=l?{connection:h,source:h.source,target:h.target,sourceId:h.sourceId,targetId:h.targetId,sourceEndpoint:h.endpoints[0],targetEndpoint:h.endpoints[1]}:h;f&&ax.fire("connectionDetached",k,n),ax.anchorManager.connectionDetached(k)},aB=ax.fireMoveEvent=function(f,d){ax.fire("connectionMoved",f,d)};this.unregisterEndpoint=function(h){h._jsPlumb.uuid&&(ai[h._jsPlumb.uuid]=null),ax.anchorManager.deleteEndpoint(h);for(var f in aj){var n=aj[f];if(n){for(var m=[],l=0,k=n.length;k>l;l++){n[l]!=h&&m.push(n[l])}aj[f]=m}aj[f].length<1&&delete aj[f]}},this.detach=function(){if(0!==arguments.length){var s=ax.Defaults.ConnectionType||ax.getDefaultConnectionType(),q=arguments[0].constructor==s,p=2==arguments.length?q?arguments[1]||{}:arguments[0]:arguments[0],o=p.fireEvent!==!1,n=p.forceDetach,m=q?arguments[0]:p.connection;if(m){(n||jsPlumbUtil.functionChain(!0,!1,[[m.endpoints[0],"isDetachAllowed",[m]],[m.endpoints[1],"isDetachAllowed",[m]],[m,"isDetachAllowed",[m]],[ax,"checkCondition",["beforeDetach",m]]]))&&m.endpoints[0].detach(m,!1,!0,o)}else{var l=u.extend({},p);if(l.uuids){aS(l.uuids[0]).detachFrom(aS(l.uuids[1]),o)}else{if(l.sourceEndpoint&&l.targetEndpoint){l.sourceEndpoint.detachFrom(l.targetEndpoint)}else{var k=aE(ax.getDOMElement(l.source)),f=aE(ax.getDOMElement(l.target));aK(k,function(d){(d.sourceId==k&&d.targetId==f||d.targetId==k&&d.sourceId==f)&&ax.checkCondition("beforeDetach",d)&&d.endpoints[0].detach(d,!1,!0,o)})}}}}},this.detachAllConnections=function(h,f){f=f||{},h=ax.getDOMElement(h);var n=aE(h),m=aj[n];if(m&&m.length){for(var l=0,k=m.length;k>l;l++){m[l].detachAll(f.fireEvent!==!1)}}return ax},this.detachEveryConnection=function(d){return d=d||{},ax.doWhileSuspended(function(){for(var f in aj){var k=aj[f];if(k&&k.length){for(var h=0,g=k.length;g>h;h++){k[h].detachAll(d.fireEvent!==!1)}}}ak.length=0}),ax},this.deleteObject=function(P){var O={endpoints:{},connections:{},endpointCount:0,connectionCount:0},s=P.fireEvent!==!1,q=P.deleteAttachedObjects!==!1,p=function(g){if(null!=g&&null==O.connections[g.id]&&(P.dontUpdateHover||null==g._jsPlumb||g.setHover(!1),O.connections[g.id]=g,O.connectionCount++,q)){for(var d=0;d<g.endpoints.length;d++){g.endpoints[d]._deleteOnDetach&&o(g.endpoints[d])}}},o=function(k){if(null!=k&&null==O.endpoints[k.id]&&(P.dontUpdateHover||null==k._jsPlumb||k.setHover(!1),O.endpoints[k.id]=k,O.endpointCount++,q)){for(var h=0;h<k.connections.length;h++){var d=k.connections[h];p(d)}}};P.connection?p(P.connection):o(P.endpoint);for(var n in O.connections){var m=O.connections[n];m._jsPlumb&&(jsPlumbUtil.removeWithFunction(ak,function(d){return m.id==d.id}),bc(m,s,P.originalEvent),m.endpoints[0].detachFromConnection(m),m.endpoints[1].detachFromConnection(m),m.cleanup(),m.destroy())}for(var l in O.endpoints){var f=O.endpoints[l];f._jsPlumb&&(ax.unregisterEndpoint(f),f.cleanup(),f.destroy())}return O},this.draggable=function(g,f){var l,k,h;if("object"==typeof g&&g.length){for(l=0,k=g.length;k>l;l++){h=aq(g[l]),h.el&&aR(h.el,!0,f,h.id)}}else{h=aq(g),h.el&&aR(h.el,!0,f,h.id)}return ax};var a7=function(h,g,n,m){for(var l=0,k=h.length;k>l;l++){h[l][g].apply(h[l],n)}return m(h)},aM=function(h,g,n){for(var m=[],l=0,k=h.length;k>l;l++){m.push([h[l][g].apply(h[l],n),h[l]])}return m},an=function(f,d,g){return function(){return a7(f,d,arguments,g)}},r=function(f,d){return function(){return aM(f,d,arguments)}},b=function(g,f){var l=[];if(g){if("string"==typeof g){if("*"===g){return g}l.push(g)}else{if(f){l=g}else{if(g.length){for(var k=0,h=g.length;h>k;k++){l.push(aq(g[k]).id)}}else{l.push(aq(g).id)}}}}return l},bf=function(f,d,g){return"*"===f?!0:f.length>0?-1!=jsPlumbUtil.indexOf(f,d):!g};this.getConnections=function(R,Q){R?R.constructor==String&&(R={scope:R}):R={};for(var P=R.scope||ax.getDefaultScope(),O=b(P,!0),s=b(R.source),q=b(R.target),p=!Q&&O.length>1?{}:[],o=function(d,h){if(!Q&&O.length>1){var g=p[d];null==g&&(g=p[d]=[]),g.push(h)}else{p.push(h)}},n=0,m=ak.length;m>n;n++){var f=ak[n];bf(O,f.scope)&&bf(s,f.sourceId)&&bf(q,f.targetId)&&o(f.scope,f)}return p};var a8=function(f,d){return function(k){for(var h=0,g=f.length;g>h;h++){k(f[h])}return d(f)}},aT=function(d){return function(f){return d[f]}},au=function(k,h){var p,o,n={length:k.length,each:a8(k,h),get:aT(k)},m=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],l=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(p=0,o=m.length;o>p;p++){n[m[p]]=an(k,m[p],h)}for(p=0,o=l.length;o>p;p++){n[l[p]]=r(k,l[p])}return n},t=function(f){var d=au(f,t);return u.extend(d,{setDetachable:an(f,"setDetachable",t),setReattach:an(f,"setReattach",t),setConnector:an(f,"setConnector",t),detach:function(){for(var g=0,h=f.length;h>g;g++){ax.detach(f[g])}},isDetachable:r(f,"isDetachable"),isReattach:r(f,"isReattach")})},c=function(f){var d=au(f,c);return u.extend(d,{setEnabled:an(f,"setEnabled",c),setAnchor:an(f,"setAnchor",c),isEnabled:r(f,"isEnabled"),detachAll:function(){for(var g=0,h=f.length;h>g;g++){f[g].detachAll()}},remove:function(){for(var g=0,h=f.length;h>g;g++){ax.deleteObject({endpoint:f[g]})}}})};this.select=function(d){return d=d||{},d.scope=d.scope||"*",t(d.connections||ax.getConnections(d,!0))},this.selectEndpoints=function(bl){bl=bl||{},bl.scope=bl.scope||"*";var bk=!bl.element&&!bl.source&&!bl.target,bj=bk?"*":b(bl.element),bb=bk?"*":b(bl.source),ab=bk?"*":b(bl.target),Z=b(bl.scope,!0),Y=[];for(var X in aj){var W=bf(bj,X,!0),V=bf(bb,X,!0),U="*"!=bb,T=bf(ab,X,!0),S="*"!=ab;if(W||V||T){bl:for(var R=0,Q=aj[X].length;Q>R;R++){var P=aj[X][R];if(bf(Z,P.scope,!0)){var O=U&&bb.length>0&&!P.isSource,s=S&&ab.length>0&&!P.isTarget;if(O||s){continue bl}Y.push(P)}}}}return c(Y)},this.getAllConnections=function(){return ak},this.getDefaultScope=function(){return a1},this.getEndpoint=aS,this.getEndpoints=function(d){return aj[aq(d).id]},this.getDefaultEndpointType=function(){return u.Endpoint},this.getDefaultConnectionType=function(){return u.Connection},this.getId=aE,this.getOffset=function(d){return a5({elId:d}).o},this.appendElement=aW;var bh=!1;this.isHoverSuspended=function(){return bh},this.setHoverSuspended=function(d){bh=d};var ba=function(d){return function(){return jsPlumbAdapter.isRenderModeAvailable(d)}};this.isSVGAvailable=ba("svg"),this.isVMLAvailable=ba("vml"),this.hide=function(f,d){return aI(f,"none",d),ax},this.idstamp=aX,this.connectorsInitialized=!1;var aZ=[],ay=["svg","vml"];this.registerConnectorType=function(f,d){aZ.push([f,d])};var aa=function(f){if(!ao&&f){var d=ax.getDOMElement(f);d.offsetParent&&ax.setContainer(d.offsetParent)}},e=function(){ax.Defaults.Container&&ax.setContainer(ax.Defaults.Container)},bi=ax.manage=function(f,d){return ah[f]||(ah[f]={el:d,endpoints:[],connections:[]},ah[f].info=a5({elId:f,timestamp:a2})),ah[f]},bd=function(d){delete ah[d]},a5=this.updateOffset=function(f){var o,n=f.timestamp,m=f.recalc,l=f.offset,k=f.elId;return a3&&!n&&(n=a2),!m&&n&&n===af[k]?{o:f.offset||ag[k],s:a4[k]}:(m||!l&&null==ag[k]?(o=ah[k]?ah[k].el:null,null!=o&&(a4[k]=ax.getSize(o),ag[k]=M(o,ax),af[k]=n)):(ag[k]=l||ag[k],null==a4[k]&&(o=ah[k].el,null!=o&&(a4[k]=ax.getSize(o))),af[k]=n),ag[k]&&!ag[k].right&&(ag[k].right=ag[k].left+a4[k][0],ag[k].bottom=ag[k].top+a4[k][1],ag[k].width=a4[k][0],ag[k].height=a4[k][1],ag[k].centerx=ag[k].left+ag[k].width/2,ag[k].centery=ag[k].top+ag[k].height/2),{o:ag[k],s:a4[k]})};this.init=function(){var f=function(k,h,l){u.Connectors[k][h]=function(){l.apply(this,arguments),u.ConnectorRenderers[k].apply(this,arguments)},jsPlumbUtil.extend(u.Connectors[k][h],[l,u.ConnectorRenderers[k]])};if(!u.connectorsInitialized){for(var d=0;d<aZ.length;d++){for(var g=0;g<ay.length;g++){f(ay[g],aZ[d][1],aZ[d][0])}}u.connectorsInitialized=!0}al||(e(),ax.anchorManager=new u.AnchorManager({jsPlumbInstance:ax}),ax.setRenderMode(ax.Defaults.RenderMode),al=!0,ax.fire("ready",ax))}.bind(this),this.log=am,this.jsPlumbUIComponent=F,this.makeAnchor=function(){var f,o=function(g,d){if(u.Anchors[g]){return new u.Anchors[g](d)}if(!ax.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown anchor type '"+g+"'"}}};if(0===arguments.length){return null}var n=arguments[0],m=arguments[1],l=(arguments[2],null);if(n.compute&&n.getOrientation){return n}if("string"==typeof n){l=o(arguments[0],{elementId:m,jsPlumbInstance:ax})}else{if(N.isArray(n)){if(N.isArray(n[0])||N.isString(n[0])){2==n.length&&N.isObject(n[1])?N.isString(n[0])?(f=u.extend({elementId:m,jsPlumbInstance:ax},n[1]),l=o(n[0],f)):(f=u.extend({elementId:m,jsPlumbInstance:ax,anchors:n[0]},n[1]),l=new u.DynamicAnchor(f)):l=new u.DynamicAnchor({anchors:n,selector:null,elementId:m,jsPlumbInstance:ax})}else{var k={x:n[0],y:n[1],orientation:n.length>=4?[n[2],n[3]]:[0,0],offsets:n.length>=6?[n[4],n[5]]:[0,0],elementId:m,jsPlumbInstance:ax,cssClass:7==n.length?n[6]:null};l=new u.Anchor(k),l.clone=function(){return new u.Anchor(k)}}}}return l.id||(l.id="anchor_"+aX()),l},this.makeAnchors=function(f,o,n){for(var m=[],l=0,k=f.length;k>l;l++){"string"==typeof f[l]?m.push(u.Anchors[f[l]]({elementId:o,jsPlumbInstance:n})):N.isArray(f[l])&&m.push(ax.makeAnchor(f[l],o,n))}return m},this.makeDynamicAnchor=function(f,d){return new u.DynamicAnchor({anchors:f,selector:d,elementId:null,jsPlumbInstance:ax})},this.targetEndpointDefinitions={};var aA=function(f,d,g){f.paintStyle=f.paintStyle||g.Defaults.EndpointStyles[d]||g.Defaults.EndpointStyle,f.hoverPaintStyle=f.hoverPaintStyle||g.Defaults.EndpointHoverStyles[d]||g.Defaults.EndpointHoverStyle,f.anchor=f.anchor||g.Defaults.Anchors[d]||g.Defaults.Anchor,f.endpoint=f.endpoint||g.Defaults.Endpoints[d]||g.Defaults.Endpoint};this.sourceEndpointDefinitions={};var ac=function(O,s,q,p,o){for(var n=O.target||O.srcElement,m=!1,l=p.getSelector(s,q),k=0;k<l.length;k++){if(l[k]==n){m=!0;break}}return o?!m:m};this.makeTarget=function(U,T,S){var R=u.extend({_jsPlumb:this},S);u.extend(R,T),aA(R,1,this);for(var Q=R.scope||ax.Defaults.Scope,P=(!(R.deleteEndpointsOnDetach===!1),R.maxConnections||-1),O=R.onMaxConnections,s=function(Z){var X=aq(Z),V=X.id,g=new F(R),Y=u.extend({},R.dropOptions||{});aa(V);var W={def:R,uniqueEndpoint:R.uniqueEndpoint,maxConnections:P,enabled:!0};X.el._jsPlumbTarget=W,this.targetEndpointDefinitions[V]=W;var k=R._jsPlumb.EndpointDropHandler({jsPlumb:ax,enabled:function(){return X.el._jsPlumbTarget.enabled},isFull:function(m){var d=ax.select({target:V}).length,o=X.el._jsPlumbTarget,n=o.maxConnections>0&&d>=o.maxConnections;return n&&O&&O({element:X.el,connection:jpc},m),n},element:X.el,elementId:V,isSource:!1,isTarget:!0,addClass:function(d){ax.addClass(X.el,d)},removeClass:function(d){ax.removeClass(X.el,d)},onDrop:function(m){var d=m.endpoints[0];d.anchor.locked=!1},isDropAllowed:function(){return g.isDropAllowed.apply(g,arguments)},getEndpoint:function(m){var bj=ax.getElementObject(X.el),bb=X.el._jsPlumbTarget,ab=bb.endpoint;if((null==ab||null==ab._jsPlumb)&&(ab=ax.addEndpoint(bj,R)),R.uniqueEndpoint&&(bb.endpoint=ab),ab._doNotDeleteOnDetach=!1,ab._deleteOnDetach=!0,m.isDetachable()&&ab.initDraggable(),null!=ab.anchor.positionFinder){var p=ax.getUIPosition(arguments,this.getZoom()),o=M(bj,this),n=ax.getSize(bj),d=ab.anchor.positionFinder(p,o,n,ab.anchor.constructorParams);ab.anchor.x=d[0],ab.anchor.y=d[1]}return ab}}),h=u.dragEvents.drop;Y.scope=Y.scope||Q,Y[h]=N.wrap(Y[h],k),R.allowLoopback===!1&&(Y.canDrop=function(m){var d=m.getDragElement()._jsPlumbRelatedElement;return d!=X.el}),this.initDroppable(this.getElementObject(X.el),Y,"internal")}.bind(this),q=U.length&&U.constructor!=String?U:[U],l=0,f=q.length;f>l;l++){s(q[l])}return this},this.unmakeTarget=function(f,d){var g=aq(f);return u.destroyDroppable(g.el),d||delete this.targetEndpointDefinitions[g.id],this},this.makeSource=function(R,Q,P){var O=u.extend({},P);u.extend(O,Q),aA(O,0,this);for(var s=O.maxConnections||1,q=O.onMaxConnections,n=function(Z){var Y=Z.id,X=this.getElementObject(Z.el),W=this.getDOMElement(X),V=function(){return null==O.parent?null:"parent"===O.parent?Z.el.parentNode:ax.getDOMElement(O.parent)},U=null!=O.parent?this.getId(V()):Y;aa(U),this.sourceEndpointDefinitions[U]={def:O,uniqueEndpoint:O.uniqueEndpoint,maxConnections:s,enabled:!0};var T=u.dragEvents.stop,S=u.dragEvents.drag,h=u.extend({},O.dragOptions||{}),g=h.drag,bk=h.stop,bj=null,bb=!1;h.scope=h.scope||O.scope,h[S]=N.wrap(h[S],function(){g&&g.apply(this,arguments),bb=!1}),h[T]=N.wrap(h[T],function(){if(bk&&bk.apply(this,arguments),this.currentlyDragging=!1,null!=bj._jsPlumb){var bu=O.anchor||this.Defaults.Anchor,bt=bj.anchor,bs=bj.connections[0],br=this.makeAnchor(bu,Y,this),bq=bj.element;if(null!=br.positionFinder){var bp=M(bq,this),bo=this.getSize(bq),bn={left:bp.left+bt.x*bo[0],top:bp.top+bt.y*bo[1]},bm=br.positionFinder(bn,bp,bo,br.constructorParams);br.x=bm[0],br.y=bm[1]}if(bj.setAnchor(br,!0),O.parent){var bl=V();if(bl){var d=O.container||ao;bj.setElement(bl,d)}}bj.repaint(),this.repaint(bj.elementId),this.repaint(bs.targetId)}}.bind(this));var ab=function(m){var d=this.getOriginalEvent(m);if(3!==m.which&&2!==m.button){var bq=this.sourceEndpointDefinitions[U];if(Y=this.getId(this.getDOMElement(X)),bq.enabled){if(O.filter){var bp=jsPlumbUtil.isString(O.filter)?ac(d,X,O.filter,this,O.filterExclude):O.filter(d,X);if(bp===!1){return}}var bo=this.select({source:U}).length;if(bq.maxConnections>=0&&bq.uniqueEndpoint&&bo>=bq.maxConnections){return q&&q({element:X,maxConnections:s},m),!1}var bn=jsPlumbAdapter.getPositionOnElement(d,W,ar),bm={};u.extend(bm,O),bm.isTemporarySource=!0,bm.anchor=[bn[0],bn[1],0,0],bm.dragOptions=h,bj=this.addEndpoint(Y,bm),bb=!0,bj.endpointWillMoveTo=O.parent?V():null,bq.uniqueEndpoint&&(bq.endpoint?bj.finalEndpoint=bq.endpoint:bq.endpoint=bj),bj._doNotDeleteOnDetach=!1,bj._deleteOnDetach=!0;var bl=function(){ax.off(bj.canvas,"mouseup",bl),ax.off(X,"mouseup",bl),bb&&(bb=!1,ax.deleteEndpoint(bj))};ax.on(bj.canvas,"mouseup",bl),ax.on(X,"mouseup",bl),ax.trigger(bj.canvas,"mousedown",m),jsPlumbUtil.consume(m)}}}.bind(this);this.on(X,"mousedown",ab),this.sourceEndpointDefinitions[U].trigger=ab,O.filter&&jsPlumbUtil.isString(O.filter)&&ax.setDragFilter(X,O.filter)}.bind(this),l=R.length&&R.constructor!=String?R:[R],k=0,f=l.length;f>k;k++){n(aq(l[k]))}return this},this.unmakeSource=function(g,f){var k=aq(g),h=this.sourceEndpointDefinitions[k.id].trigger;return h&&ax.off(k.el,"mousedown",h),f||delete this.sourceEndpointDefinitions[k.id],this},this.unmakeEverySource=function(){for(var d in this.sourceEndpointDefinitions){ax.unmakeSource(d,!0)}return this.sourceEndpointDefinitions={},this};var i=function(g,f){f=jsPlumbUtil.isArray(f)?f:[f];for(var l=aE(g),k=0;k<f.length;k++){var h=this[f[k]][l];if(h){return h.def.scope||this.Defaults.Scope}}}.bind(this),a=function(h,g,n){n=jsPlumbUtil.isArray(n)?n:[n];for(var m=aE(h),l=0;l<n.length;l++){var k=this[n[l]][m];k&&(k.def.scope=g,null!=this.scopeChange&&this.scopeChange(h,m,aj[m],g,n[l]))}}.bind(this);this.getScope=function(d){return i(d,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(d){return i(d,"sourceEndpointDefinitions")},this.getTargetScope=function(d){return i(d,"targetEndpointDefinitions")},this.setScope=function(f,d){a(f,d,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.setSourceScope=function(f,d){a(f,d,"sourceEndpointDefinitions")},this.setTargetScope=function(f,d){a(f,d,"targetEndpointDefinitions")},this.unmakeEveryTarget=function(){for(var d in this.targetEndpointDefinitions){ax.unmakeTarget(d,!0)}return this.targetEndpointDefinitions={},this};var be=function(O,s,q,p){var o="source"==O?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;if(N.isString(s)){o[s].enabled=p?!o[s].enabled:q}else{if(s.length){for(var n=0,m=s.length;m>n;n++){var l=aq(s[n]);o[l.id]&&(o[l.id].enabled=p?!o[l.id].enabled:q)}}else{var k=aq(s).id;o[k].enabled=p?!o[k].enabled:q}}return this}.bind(this),a6=function(d,f){return N.isString(d)||!d.length?f.apply(this,[d]):d.length?f.apply(this,[d[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(d){return be("source",d,null,!0),this.isSourceEnabled(d)},this.setSourceEnabled=function(f,d){return be("source",f,d)},this.isSource=function(d){return a6(d,function(f){return null!=this.sourceEndpointDefinitions[aq(f).id]}.bind(this))},this.isSourceEnabled=function(d){return a6(d,function(g){var f=this.sourceEndpointDefinitions[aq(g).id];return f&&f.enabled===!0}.bind(this))},this.toggleTargetEnabled=function(d){return be("target",d,null,!0),this.isTargetEnabled(d)},this.isTarget=function(d){return a6(d,function(f){return null!=this.targetEndpointDefinitions[aq(f).id]}.bind(this))},this.isTargetEnabled=function(d){return a6(d,function(g){var f=this.targetEndpointDefinitions[aq(g).id];return f&&f.enabled===!0}.bind(this))},this.setTargetEnabled=function(f,d){return be("target",f,d)},this.ready=function(d){ax.bind("ready",d)},this.repaint=function(g,f,l){if("object"==typeof g&&g.length){for(var k=0,h=g.length;h>k;k++){aV(g[k],f,l)}}else{aV(g,f,l)}return ax},this.revalidate=function(f){var d=ax.getId(f);return ax.updateOffset({elId:d,recalc:!0}),ax.repaint(f)},this.repaintEverything=function(g){var f,h=L();for(f in aj){ax.updateOffset({elId:f,recalc:!0,timestamp:h})}for(f in aj){aV(f,null,h,g)}return this},this.removeAllEndpoints=function(f,d){var g=function(k){var o,n,m=aq(k),l=aj[m.id];if(l){for(o=0,n=l.length;n>o;o++){ax.deleteEndpoint(l[o])}}if(delete aj[m.id],d&&m.el&&3!=m.el.nodeType&&8!=m.el.nodeType){for(o=0,n=m.el.childNodes.length;n>o;o++){g(m.el.childNodes[o])}}};return g(f),this},this.remove=function(f,d){var g=aq(f);return ax.doWhileSuspended(function(){ax.removeAllEndpoints(g.id,!0),ax.dragManager.elementRemoved(g.id),delete ax.floatingConnections[g.id],ax.anchorManager.clearFor(g.id),ax.anchorManager.removeFloatingConnection(g.id)},d===!1),bd(g.id),g.el&&(ax.removeElement(g.el),g.el._jsPlumb=null),ax},this.reset=function(){ax.setSuspendEvents(!0),ax.deleteEveryEndpoint(),ax.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},ak.length=0,ax.setSuspendEvents(!1)};var bg=function(d){d.canvas&&d.canvas.parentNode&&d.canvas.parentNode.removeChild(d.canvas),d.cleanup(),d.destroy()},a9=function(d){bg(d)};this.clear=function(){ax.select().each(a9),ax.selectEndpoints().each(a9),aj={},ai={}},this.setDefaultScope=function(d){return a1=d,ax},this.setDraggable=aJ,this.setId=function(O,s,q){var p;jsPlumbUtil.isString(O)?p=O:(O=this.getDOMElement(O),p=this.getId(O));var o=this.getConnections({source:p,scope:"*"},!0),n=this.getConnections({target:p,scope:"*"},!0);s=""+s,q?O=this.getDOMElement(s):(O=this.getDOMElement(p),this.setAttribute(O,"id",s)),aj[s]=aj[p]||[];for(var m=0,l=aj[s].length;l>m;m++){aj[s][m].setElementId(s),aj[s][m].setReferenceElement(O)}delete aj[p],this.anchorManager.changeId(p,s),this.dragManager&&this.dragManager.changeId(p,s),ah[s]=ah[p],delete ah[p];var k=function(S,R,Q){for(var P=0,h=S.length;h>P;P++){S[P].endpoints[R].setElementId(s),S[P].endpoints[R].setReferenceElement(O),S[P][Q+"Id"]=s,S[P][Q]=O}};k(o,0,"source"),k(n,1,"target"),this.repaint(s)},this.setDebugLog=function(d){am=d},this.setSuspendDrawing=function(f,d){var g=a3;return a3=f,a2=f?(new Date).getTime():null,d&&this.repaintEverything(),g},this.isSuspendDrawing=function(){return a3},this.getSuspendedAt=function(){return a2},this.doWhileSuspended=function(f,k){var h=this.isSuspendDrawing();h||this.setSuspendDrawing(!0);try{f()}catch(g){N.log("Function run while suspended failed",g)}h||this.setSuspendDrawing(!1,!k)},this.getOffset=function(d){return ag[d]},this.getCachedData=aF,this.timestamp=L,this.setRenderMode=function(d){if(d!==u.SVG&&d!==u.VML){throw new TypeError("Render mode ["+d+"] not supported")}return a0=jsPlumbAdapter.setRenderMode(d)},this.getRenderMode=function(){return a0},this.show=function(f,d){return aI(f,"block",d),ax},this.toggleVisible=aG,this.toggleDraggable=aH,this.addListener=this.bind,jsPlumbAdapter.headless||(ax.dragManager=jsPlumbAdapter.getDragManager(ax),ax.recalculateOffsets=ax.dragManager.updateOffsets)};jsPlumbUtil.extend(v,jsPlumbUtil.EventGenerator,{setAttribute:function(e,d,f){this.setAttribute(e,d,f)},getAttribute:function(d,c){return this.getAttribute(u.getDOMElement(d),c)},registerConnectionType:function(d,c){this._connectionTypes[d]=u.extend({},c)},registerConnectionTypes:function(d){for(var c in d){this._connectionTypes[c]=u.extend({},d[c])}},registerEndpointType:function(d,c){this._endpointTypes[d]=u.extend({},c)},registerEndpointTypes:function(d){for(var c in d){this._endpointTypes[c]=u.extend({},d[c])}},getType:function(d,c){return"connection"===c?this._connectionTypes[d]:this._endpointTypes[d]},setIdChanged:function(d,c){this.setId(d,c,!0)},setParent:function(k,i){var q=this.getElementObject(k),p=this.getDOMElement(q),o=this.getId(p),n=this.getElementObject(i),m=this.getDOMElement(n),l=this.getId(m);p.parentNode.removeChild(p),m.appendChild(p),this.dragManager.setParent(q,o,n,l)},getSize:function(b){return[b.offsetWidth,b.offsetHeight]},getWidth:function(b){return b.offsetWidth},getHeight:function(b){return b.offsetHeight},extend:function(f,e,h){var g;if(h){for(g=0;g<h.length;g++){f[h[g]]=e[h[g]]}}else{for(g in e){f[g]=e[g]}}return f},floatingConnections:{},getFloatingAnchorIndex:function(b){return b.endpoints[0].isFloating()?0:1}},jsPlumbAdapter);var u=new v;"undefined"!=typeof window&&(window.jsPlumb=u),u.getInstance=function(d){var c=new v(d);return c.init(),c},"function"==typeof define&&(define("jsplumb",[],function(){return u}),define("jsplumbinstance",[],function(){return u.getInstance()})),"undefined"!=typeof exports&&(exports.jsPlumb=u)}(),function(){var h=function(e,d){var f=!1;return{drag:function(){if(f){return f=!1,!0}var a=jsPlumb.getUIPosition(arguments,d.getZoom());e.element&&(jsPlumbAdapter.setPosition(e.element,a),d.repaint(e.element,a))},stopDrag:function(){f=!0}}},g=function(n,f){var q=document.createElement("div");q.style.position="absolute";var p=f.getContainer()||document.body;p.appendChild(q);var o=f.getId(q);f.manage(o,q),n.id=o,n.element=q},m=function(v,u,t,s,r,q,p,o){var n=new jsPlumb.FloatingAnchor({reference:u,referenceCanvas:s,jsPlumbInstance:q});return p({paintStyle:v,endpoint:t,anchor:n,source:r,scope:o})},l=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],k=function(f,e){var o=0;if(null!=e){for(var n=0;n<f.connections.length;n++){if(f.connections[n].sourceId==e||f.connections[n].targetId==e){o=n;break}}}return f.connections[o]},i=function(d,c){return jsPlumbUtil.findWithFunction(c.connections,function(a){return a.id==d.id})};jsPlumb.Endpoint=function(x){var w=x._jsPlumb,v=jsPlumb.getElementObject,u=jsPlumbUtil,t=x.newConnection,s=x.newEndpoint;x.finaliseConnection,x.fireMoveEvent,this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[0.5,0.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:x.connectorStyle,connectorHoverStyle:x.connectorHoverStyle,connectorClass:x.connectorClass,connectorHoverClass:x.connectorHoverClass,connectorOverlays:x.connectorOverlays,connector:x.connector,connectorTooltip:x.connectorTooltip}},this._jsPlumb.enabled=!(x.enabled===!1),this._jsPlumb.visible=!0,this.element=jsPlumb.getDOMElement(x.source),this._jsPlumb.uuid=x.uuid,this._jsPlumb.floatingEndpoint=null;var f=null;this._jsPlumb.uuid&&(x.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=x.elementId,this._jsPlumb.connectionCost=x.connectionCost,this._jsPlumb.connectionsDirected=x.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var e=function(){var n=this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass(),jsPlumbAdapter.updateClasses(this.element,w.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass,w.endpointAnchorClassPrefix+"_"+n),this.updateClasses(w.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass,w.endpointAnchorClassPrefix+"_"+n)}.bind(this);this.setAnchor=function(o,n){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=this._jsPlumb.instance.makeAnchor(o,this.elementId,w),e(),this.anchor.bind("anchorChanged",function(p){this.fire("anchorChanged",{endpoint:this,anchor:p}),e()}.bind(this)),n||this._jsPlumb.instance.repaint(this.elementId),this};var d=x.anchor?x.anchor:x.anchors?x.anchors:w.Defaults.Anchor||"Top";this.setAnchor(d,!0);var c=function(o){if(this.connections.length>0){for(var n=0;n<this.connections.length;n++){this.connections[n].setHover(o,!1)}}else{this.setHover(o)}}.bind(this);this.bind("mouseover",function(){c(!0)}),this.bind("mouseout",function(){c(!1)}),x._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.setEndpoint=function(o){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy());var n=function(r,q){var y=w.getRenderMode();if(jsPlumb.Endpoints[y][r]){return new jsPlumb.Endpoints[y][r](q)}if(!w.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown endpoint type '"+r+"'"}}},p={_jsPlumb:this._jsPlumb.instance,cssClass:x.cssClass,container:x.container,tooltip:x.tooltip,connectorTooltip:x.connectorTooltip,endpoint:this};u.isString(o)?this.endpoint=n(o,p):u.isArray(o)?(p=u.merge(o[1],p),this.endpoint=n(o[0],p)):this.endpoint=o.clone(),this.endpoint.clone=function(){return u.isString(o)?n(o,p):u.isArray(o)?(p=u.merge(o[1],p),n(o[0],p)):void 0}.bind(this),this.type=this.endpoint.type},this.setEndpoint(x.endpoint||w.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot"),this.setPaintStyle(x.endpointStyle||x.paintStyle||x.style||w.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(x.endpointHoverStyle||x.hoverPaintStyle||w.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),jsPlumb.extend(this,x,l),this.isSource=x.isSource||!1,this.isTemporarySource=x.isTemporarySource||!1,this.isTarget=x.isTarget||!1,this._jsPlumb.maxConnections=x.maxConnections||w.Defaults.MaxConnections,this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.addClass(w.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),jsPlumbAdapter.addClass(this.element,w.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.connections=x.connections||[],this.connectorPointerEvents=x["connector-pointer-events"],this.scope=x.scope||w.getDefaultScope(),this.timestamp=null,this.reattachConnections=x.reattach||w.Defaults.ReattachConnections,this.connectionsDetachable=w.Defaults.ConnectionsDetachable,(x.connectionsDetachable===!1||x.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=x.dragAllowedWhenFull!==!1,x.onMaxConnections&&this.bind("maxConnections",x.onMaxConnections),this.addConnection=function(n){this.connections.push(n),this[(this.connections.length>0?"add":"remove")+"Class"](w.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](w.endpointFullClass)},this.detachFromConnection=function(o,n,p){n=null==n?i(o,this):n,n>=0&&(this.connections.splice(n,1),this[(this.connections.length>0?"add":"remove")+"Class"](w.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](w.endpointFullClass)),!p&&this._deleteOnDetach&&0===this.connections.length&&w.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!1})},this.detach=function(B,A,z,y,r,q,p){var o=null==p?i(B,this):p,n=!1;return y=y!==!1,o>=0&&(z||B._forceDetach||B.isDetachable()&&B.isDetachAllowed(B)&&this.isDetachAllowed(B)&&w.checkCondition("beforeDetach",B))&&(w.deleteObject({connection:B,fireEvent:!A&&y,originalEvent:r,deleteAttachedObjects:!1}),n=!0),n},this.detachAll=function(o,n){for(;this.connections.length>0;){this.detach(this.connections[0],!1,!0,o!==!1,n,this,0)}return this},this.detachFrom=function(o,n,y){for(var r=[],q=0;q<this.connections.length;q++){(this.connections[q].endpoints[1]==o||this.connections[q].endpoints[0]==o)&&r.push(this.connections[q])}for(var p=0;p<r.length;p++){this.detach(r[p],!1,!0,n,y)}return this},this.getElement=function(){return this.element},this.setElement=function(o){var n=this._jsPlumb.instance.getId(o),p=this.elementId;return u.removeWithFunction(x.endpointsByElement[this.elementId],function(q){return q.id==this.id}.bind(this)),this.element=jsPlumb.getDOMElement(o),this.elementId=w.getId(this.element),w.anchorManager.rehomeEndpoint(this,p,this.element),w.dragManager.endpointAdded(this.element),u.addToList(x.endpointsByElement,n,this),this},this.makeInPlaceCopy=function(){var o=this.anchor.getCurrentLocation({element:this}),n=this.anchor.getOrientation(this),q=this.anchor.getCssClass(),p={bind:function(){},compute:function(){return[o[0],o[1]]},getCurrentLocation:function(){return[o[0],o[1]]},getOrientation:function(){return n},getCssClass:function(){return q}};return s({dropOptions:x.dropOptions,anchor:p,source:this.element,paintStyle:this.getPaintStyle(),endpoint:x.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope})},this.connectorSelector=function(){var n=this.connections[0];return this.isTarget&&n?n:this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:n},this.setStyle=this.setPaintStyle,this.paint=function(N){N=N||{};var M=N.timestamp,L=!(N.recalc===!1);if(!M||this.timestamp!==M){var K=w.updateOffset({elId:this.elementId,timestamp:M}),J=N.offset?N.offset.o:K.o;if(null!=J){var I=N.anchorPoint,H=N.connectorPaintStyle;if(null==I){var G=N.dimensions||K.s,F={xy:[J.left,J.top],wh:G,element:this,timestamp:M};if(L&&this.anchor.isDynamic&&this.connections.length>0){var E=k(this,N.elementWithPrecedence),D=E.endpoints[0]==this?1:0,C=0===D?E.sourceId:E.targetId,B=w.getCachedData(C),A=B.o,z=B.s;F.txy=[A.left,A.top],F.twh=z,F.tElement=E.endpoints[D]}I=this.anchor.compute(F)}this.endpoint.compute(I,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,H||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=M;for(var y=0;y<this._jsPlumb.overlays.length;y++){var O=this._jsPlumb.overlays[y];O.isVisible()&&(this._jsPlumb.overlayPlacements[y]=O.draw(this.endpoint,this._jsPlumb.paintStyleInUse),O.paint(this._jsPlumb.overlayPlacements[y]))}}}},this.repaint=this.paint;var b=!1;this.initDraggable=function(){if(!b&&jsPlumb.isDragSupported(this.element)){var D={id:null,element:null},C=null,B=!1,A=null,z=h(D,w),y=x.dragOptions||{},q={},I=jsPlumb.dragEvents.start,H=jsPlumb.dragEvents.stop,G=jsPlumb.dragEvents.drag,F=function(){C=this.connectorSelector();var n=!0;if(this.isEnabled()||(n=!1),null!=C||this.isSource||this.isTemporarySource||(n=!1),this.isSource&&this.isFull()&&!this.dragAllowedWhenFull&&(n=!1),null==C||C.isDetachable()||(n=!1),n===!1){return w.stopDrag&&w.stopDrag(this.canvas),z.stopDrag(),!1}for(var O=0;O<this.connections.length;O++){this.connections[O].setHover(!1)}this.addClass("endpointDrag"),w.setConnectionBeingDragged(!0),C&&!this.isFull()&&this.isSource&&(C=null),w.updateOffset({elId:this.elementId}),f=this.makeInPlaceCopy(),f.referenceEndpoint=this,f.paint(),g(D,w);var N=v(f.canvas),M=jsPlumbAdapter.getOffset(N,this._jsPlumb.instance),L=v(this.canvas);if(jsPlumbAdapter.setPosition(D.element,M),this.parentAnchor&&(this.anchor=w.makeAnchor(this.parentAnchor,this.elementId,w)),w.setAttribute(this.canvas,"dragId",D.id),w.setAttribute(this.canvas,"elId",this.elementId),this._jsPlumb.floatingEndpoint=m(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,D.element,w,s,this.scope),this.canvas.style.visibility="hidden",null==C){this.anchor.locked=!0,this.setHover(!1,!1),C=t({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:D.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:x.connectorStyle,hoverPaintStyle:x.connectorHoverStyle,connector:x.connector,overlays:x.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass}),C.addClass(w.draggingClass),this._jsPlumb.floatingEndpoint.addClass(w.draggingClass),w.fire("connectionDrag",C)}else{B=!0,C.setHover(!1);var K=C.endpoints[0].id==this.id?0:1;this.detachFromConnection(C,null,!0);var J=w.getDragScope(L);w.setAttribute(this.canvas,"originalScope",J);var o=w.getDropScope(L);w.setDragScope(L,o),w.fire("connectionDrag",C),0===K?(A=[C.source,C.sourceId,L,J],C.source=D.element,C.sourceId=D.id):(A=[C.target,C.targetId,L,J],C.target=D.element,C.targetId=D.id),C.endpoints[0===K?1:0].anchor.locked=!0,C.suspendedEndpoint=C.endpoints[K],C.suspendedElement=C.endpoints[K].getElement(),C.suspendedElementId=C.endpoints[K].elementId,C.suspendedElementType=0===K?"source":"target",C.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=C.suspendedEndpoint,C.endpoints[K]=this._jsPlumb.floatingEndpoint,C.addClass(w.draggingClass),this._jsPlumb.floatingEndpoint.addClass(w.draggingClass)}w.floatingConnections[D.id]=C,w.anchorManager.addFloatingConnection(D.id,C),u.addToList(x.endpointsByElement,D.id,this._jsPlumb.floatingEndpoint),w.currentlyDragging=!0}.bind(this),E=function(){if(w.setConnectionBeingDragged(!1),C&&null!=C.endpoints){var o=w.getDropEvent(arguments),n=w.getFloatingAnchorIndex(C);if(C.endpoints[0===n?1:0].anchor.locked=!1,C.removeClass(w.draggingClass),this._jsPlumb&&(C.deleteConnectionNow||C.endpoints[n]==this._jsPlumb.floatingEndpoint)&&B&&C.suspendedEndpoint){0===n?(C.source=A[0],C.sourceId=A[1]):(C.target=A[0],C.targetId=A[1]);var p=this._jsPlumb.floatingEndpoint;w.setDragScope(A[2],A[3]),C.endpoints[n]=C.suspendedEndpoint,C.isReattach()||C._forceReattach||C._forceDetach||!C.endpoints[0===n?1:0].detach(C,!1,!1,!0,o)?(C.setHover(!1),C._forceDetach=null,C._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(C),C.suspendedEndpoint.addConnection(C),w.repaint(A[1])):w.deleteObject({endpoint:p})}w.remove(D.element,!1),w.deleteObject({endpoint:f}),this.deleteAfterDragStop?w.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1})),w.fire("connectionDragStop",C,o),w.currentlyDragging=!1,C=null}}.bind(this);y=jsPlumb.extend(q,y),y.scope=this.scope||y.scope,y[I]=u.wrap(y[I],F,!1),y[G]=u.wrap(y[G],z.drag),y[H]=u.wrap(y[H],E),y.canDrag=function(){return this.isSource||this.isTemporarySource||this.isTarget&&this.connections.length>0}.bind(this),w.initDraggable(this.canvas,y,"internal"),this.canvas._jsPlumbRelatedElement=this.element,b=!0}},(this.isSource||this.isTarget||this.isTemporarySource)&&this.initDraggable();var a=function(C,B,A,z){if((this.isTarget||B)&&jsPlumb.isDropSupported(this.element)){var y=x.dropOptions||w.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;y=jsPlumb.extend({},y),y.scope=y.scope||this.scope;var r=jsPlumb.dragEvents.drop,q=jsPlumb.dragEvents.over,p=jsPlumb.dragEvents.out,o=this,n=w.EndpointDropHandler({getEndpoint:function(){return o},jsPlumb:w,enabled:function(){return null!=z?z.isEnabled():!0},isFull:function(){return z.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(D){o.addClass(D)},removeClass:function(D){o.removeClass(D)},isDropAllowed:function(){return o.isDropAllowed.apply(o,arguments)}});y[r]=u.wrap(y[r],n),y[q]=u.wrap(y[q],function(){var E=jsPlumb.getDragObject(arguments),D=w.getAttribute(jsPlumb.getDOMElement(E),"dragId"),I=w.floatingConnections[D];if(null!=I){var H=w.getFloatingAnchorIndex(I),G=this.isTarget&&0!==H||I.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==I.suspendedEndpoint.id;if(G){var F=w.checkCondition("checkDropAllowed",{sourceEndpoint:I.endpoints[H],targetEndpoint:this,connection:I});this[(F?"add":"remove")+"Class"](w.endpointDropAllowedClass),this[(F?"remove":"add")+"Class"](w.endpointDropForbiddenClass),I.endpoints[H].anchor.over(this.anchor,this)}}}.bind(this)),y[p]=u.wrap(y[p],function(){var E=jsPlumb.getDragObject(arguments),D=null==E?null:w.getAttribute(jsPlumb.getDOMElement(E),"dragId"),H=D?w.floatingConnections[D]:null;if(null!=H){var G=w.getFloatingAnchorIndex(H),F=this.isTarget&&0!==G||H.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==H.suspendedEndpoint.id;F&&(this.removeClass(w.endpointDropAllowedClass),this.removeClass(w.endpointDropForbiddenClass),H.endpoints[G].anchor.out())}}.bind(this)),w.initDroppable(C,y,"internal",A)}}.bind(this);return this.anchor.isFloating||a(v(this.canvas),!0,!(x._transient||this.anchor.isFloating),this),x.type&&this.addType(x.type,x.data,w.isSuspendDrawing()),this},jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n,f,q){if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!f){for(var p=0;p<this.connections.length;p++){if(this.connections[p].setVisible(n),!q){var o=this===this.connections[p].endpoints[0]?1:0;1==this.connections[p].endpoints[o].connections.length&&this.connections[p].endpoints[o].setVisible(n,!0,!0)}}}},getAttachedElements:function(){return this.connections},applyType:function(b){this.setPaintStyle(b.endpointStyle||b.paintStyle),this.setHoverPaintStyle(b.endpointHoverStyle||b.hoverPaintStyle),null!=b.maxConnections&&(this._jsPlumb.maxConnections=b.maxConnections),b.scope&&(this.scope=b.scope),jsPlumb.extend(this,b,l),b.anchor&&(this.anchor=this._jsPlumb.instance.makeAnchor(b.anchor)),null!=b.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,b.cssClass)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(b){this._jsPlumb.enabled=b},cleanup:function(){jsPlumbAdapter.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.anchor=null,this.endpoint.cleanup(),this.endpoint.destroy(),this.endpoint=null;var b=jsPlumb.getElementObject(this.canvas);this._jsPlumb.instance.destroyDraggable(b,"internal"),this._jsPlumb.instance.destroyDroppable(b,"internal")},setHover:function(b){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(b)},isFull:function(){return !(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(e){var d=!1;if(e){for(var f=0;f<this.connections.length;f++){if(this.connections[f].endpoints[1]==e||this.connections[f].endpoints[0]==e){d=!0;break}}}return d},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(b){this._jsPlumb.connectionCost=b},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(b){this._jsPlumb.connectionsDirected=b},setElementId:function(b){this.elementId=b,this.anchor.elementId=b},setReferenceElement:function(b){this.element=jsPlumb.getDOMElement(b)},setDragAllowedWhenFull:function(b){this.dragAllowedWhenFull=b},equals:function(b){return this.anchor.equals(b.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(b){return this.anchor.compute(b)}}),jsPlumbInstance.prototype.EndpointDropHandler=function(b){return function(z){var y=b.jsPlumb;b.removeClass(y.endpointDropAllowedClass),b.removeClass(y.endpointDropForbiddenClass);var x=y.getDropEvent(arguments),w=y.getDOMElement(y.getDragObject(arguments)),v=y.getAttribute(w,"dragId"),u=(y.getAttribute(w,"elId"),y.getAttribute(w,"originalScope")),t=y.floatingConnections[v];if(null!=t){var s=b.getEndpoint(t);b.onDrop&&b.onDrop(t);var r=t.suspendedEndpoint&&(t.suspendedEndpoint.id==s.id||s.referenceEndpoint&&t.suspendedEndpoint.id==s.referenceEndpoint.id);if(r){return t._forceReattach=!0,t.setHover(!1),void 0}var q=y.getFloatingAnchorIndex(t);if(u&&y.setDragScope(w,u),b.isFull(z)&&s.fire("maxConnections",{endpoint:this,connection:t,maxConnections:s._jsPlumb.maxConnections},x),!b.isFull()&&(0!==q||b.isSource)&&(1!=q||b.isTarget)&&b.enabled()){var p=!0;t.suspendedEndpoint&&t.suspendedEndpoint.id!=s.id&&(t.isDetachAllowed(t)&&t.endpoints[q].isDetachAllowed(t)&&t.suspendedEndpoint.isDetachAllowed(t)&&y.checkCondition("beforeDetach",t)||(p=!1)),0===q?(t.source=b.element,t.sourceId=b.elementId):(t.target=b.element,t.targetId=b.elementId);var o=function(){t.endpoints[q].detachFromConnection(t),t.suspendedEndpoint&&t.suspendedEndpoint.detachFromConnection(t),t.endpoints[q]=s,s.addConnection(t);var d=s.getParameters();for(var c in d){t.setParameter(c,d[c])}if(t.suspendedEndpoint){var A=t.suspendedEndpoint.elementId;y.fireMoveEvent({index:q,originalSourceId:0===q?A:t.sourceId,newSourceId:0===q?s.elementId:t.sourceId,originalTargetId:1==q?A:t.targetId,newTargetId:1==q?s.elementId:t.targetId,originalSourceEndpoint:0===q?t.suspendedEndpoint:t.endpoints[0],newSourceEndpoint:0===q?s:t.endpoints[0],originalTargetEndpoint:1==q?t.suspendedEndpoint:t.endpoints[1],newTargetEndpoint:1==q?s:t.endpoints[1],connection:t},x)}else{d.draggable&&y.initDraggable(this.element,dragOptions,"internal",y)}if(1==q?y.anchorManager.updateOtherEndpoint(t.sourceId,t.suspendedElementId,t.targetId,t):y.anchorManager.sourceChanged(t.suspendedEndpoint.elementId,t.sourceId,t),t.endpoints[0].finalEndpoint){var n=t.endpoints[0];n.detachFromConnection(t),t.endpoints[0]=t.endpoints[0].finalEndpoint,t.endpoints[0].addConnection(t)}y.finaliseConnection(t,null,x),t.setHover(!1)}.bind(this),a=function(){t.suspendedEndpoint&&(t.endpoints[q]=t.suspendedEndpoint,t.setHover(!1),t._forceDetach=!0,0===q?(t.source=t.suspendedEndpoint.element,t.sourceId=t.suspendedEndpoint.elementId):(t.target=t.suspendedEndpoint.element,t.targetId=t.suspendedEndpoint.elementId),t.suspendedEndpoint.addConnection(t),y.repaint(t.sourceId),t._forceDetach=!1)};p=p&&b.isDropAllowed(t.sourceId,t.targetId,t.scope,t,s),p?o():a()}y.currentlyDragging=!1}}}}(),function(){var d=function(g,f,k,i,h){if(!g.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[f][k]){throw {msg:"jsPlumb: unknown connector type '"+k+"'"}}return new jsPlumb.Connectors[f][k](i,h)},c=function(f,e,g){return f?g.makeAnchor(f,e,g):null};jsPlumb.Connection=function(H){var G=H.newEndpoint,F=jsPlumbUtil;this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=0.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=H.previousConnection,this.source=jsPlumb.getDOMElement(H.source),this.target=jsPlumb.getDOMElement(H.target),H.sourceEndpoint&&(this.source=H.sourceEndpoint.endpointWillMoveTo||H.sourceEndpoint.getElement()),H.targetEndpoint&&(this.target=H.targetEndpoint.getElement()),OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=H.scope,this.endpoints=[],this.endpointStyles=[];var E=this._jsPlumb.instance;E.manage(this.sourceId,this.source),E.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.editable=H.editable===!0,this._jsPlumb.params={cssClass:H.cssClass,container:H.container,"pointer-events":H["pointer-events"],editorParams:H.editorParams},this._jsPlumb.lastPaintedAt=null,this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}},this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(i,h,b,a){return b=b||this._jsPlumb.instance.getId(h),this.prepareEndpoint(E,G,this,a,i?0:1,H,h,b)};var D=this.makeEndpoint(!0,this.source,this.sourceId,H.sourceEndpoint),C=this.makeEndpoint(!1,this.target,this.targetId,H.targetEndpoint);D&&F.addToList(H.endpointsByElement,this.sourceId,D),C&&F.addToList(H.endpointsByElement,this.targetId,C),this.scope||(this.scope=this.endpoints[0].scope),null!=H.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=H.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=H.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||H.connector||E.Defaults.Connector||jsPlumb.Defaults.Connector,!0,!0),H.path&&this.connector.setPath(H.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||H.paintStyle||E.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||H.hoverPaintStyle||E.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle();var B=E.getSuspendedAt();if(!E.isSuspendDrawing()){var A=E.getCachedData(this.sourceId),z=A.o,y=A.s,x=E.getCachedData(this.targetId),w=x.o,v=x.s,u=B||E.timestamp(),t=this.endpoints[0].anchor.compute({xy:[z.left,z.top],wh:y,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[w.left,w.top],twh:v,tElement:this.endpoints[1],timestamp:u});this.endpoints[0].paint({anchorLoc:t,timestamp:u}),t=this.endpoints[1].anchor.compute({xy:[w.left,w.top],wh:v,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[z.left,z.top],twh:y,tElement:this.endpoints[0],timestamp:u}),this.endpoints[1].paint({anchorLoc:t,timestamp:u})}this._jsPlumb.detachable=E.Defaults.ConnectionsDetachable,H.detachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[0].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[1].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this._jsPlumb.reattach=H.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||E.Defaults.ReattachConnections,this._jsPlumb.cost=H.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=H.directed,null==H.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var s=jsPlumb.extend({},this.endpoints[1].getParameters());jsPlumb.extend(s,this.endpoints[0].getParameters()),jsPlumb.extend(s,this.getParameters()),this.setParameters(s);var r=[H.type,this.endpoints[0].connectionType,this.endpoints[1].connectionType].join(" ");/[^\s]/.test(r)&&this.addType(r,H.data,!0)},jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(f,e){null!=f.detachable&&this.setDetachable(f.detachable),null!=f.reattach&&this.setReattach(f.reattach),f.scope&&(this.scope=f.scope),this.setConnector(f.connector,e),null!=f.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,f.cssClass),f.anchor?(this.endpoints[0].anchor=this._jsPlumb.instance.makeAnchor(f.anchor),this.endpoints[1].anchor=this._jsPlumb.instance.makeAnchor(f.anchor)):f.anchors&&(this.endpoints[0].anchor=this._jsPlumb.instance.makeAnchor(f.anchors[0]),this.endpoints[1].anchor=this._jsPlumb.instance.makeAnchor(f.anchors[1]))},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(f,e){e&&(this.endpoints[0].addClass(f),this.endpoints[1].addClass(f),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(f)),this.connector&&this.connector.addClass(f)},removeClass:function(f,e){e&&(this.endpoints[0].removeClass(f),this.endpoints[1].removeClass(f),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(f)),this.connector&&this.connector.removeClass(f)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(b){this._jsPlumb.visible=b,this.connector&&this.connector.setVisible(b),this.repaint()},cleanup:function(){this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(),this.connector.destroy()),this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===!0},setDetachable:function(b){this._jsPlumb.detachable=b===!0},isReattach:function(){return this._jsPlumb.reattach===!0},setReattach:function(b){this._jsPlumb.reattach=b===!0},setHover:function(b){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(b),jsPlumbAdapter[b?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),jsPlumbAdapter[b?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getCost:function(){return this._jsPlumb.cost},setCost:function(b){this._jsPlumb.cost=b},isDirected:function(){return this._jsPlumb.directed===!0},getConnector:function(){return this.connector},setConnector:function(a,m,l){var k=jsPlumbUtil;null!=this.connector&&(this.connector.cleanup(),this.connector.destroy());var i={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},h=this._jsPlumb.instance.getRenderMode();k.isString(a)?this.connector=d(this._jsPlumb.instance,h,a,i,this):k.isArray(a)&&(this.connector=1==a.length?d(this._jsPlumb.instance,h,a[0],i,this):d(this._jsPlumb.instance,h,a[0],k.merge(a[1],i),this)),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),l||this.setListenerComponent(this.connector),m||this.repaint()},paint:function(P){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){P=P||{};var O=P.timestamp,N=!1,M=N?this.sourceId:this.targetId,L=N?this.targetId:this.sourceId,K=N?0:1,J=N?1:0;if(null==O||O!=this._jsPlumb.lastPaintedAt){var I=this._jsPlumb.instance.getOffset(L),H=this._jsPlumb.instance.getOffset(M),G=this.endpoints[J],F=this.endpoints[K],E=G.anchor.getCurrentLocation({xy:[I.left,I.top],wh:[I.width,I.height],element:G,timestamp:O}),D=F.anchor.getCurrentLocation({xy:[H.left,H.top],wh:[H.width,H.height],element:F,timestamp:O});this.connector.resetBounds(),this.connector.compute({sourcePos:E,targetPos:D,sourceEndpoint:this.endpoints[J],targetEndpoint:this.endpoints[K],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:I,targetInfo:H});for(var C={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},B=0;B<this._jsPlumb.overlays.length;B++){var A=this._jsPlumb.overlays[B];A.isVisible()&&(this._jsPlumb.overlayPlacements[B]=A.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(A)),C.minX=Math.min(C.minX,this._jsPlumb.overlayPlacements[B].minX),C.maxX=Math.max(C.maxX,this._jsPlumb.overlayPlacements[B].maxX),C.minY=Math.min(C.minY,this._jsPlumb.overlayPlacements[B].minY),C.maxY=Math.max(C.maxY,this._jsPlumb.overlayPlacements[B].maxY))}var z=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,y=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),x={xmin:Math.min(this.connector.bounds.minX-(z+y),C.minX),ymin:Math.min(this.connector.bounds.minY-(z+y),C.minY),xmax:Math.max(this.connector.bounds.maxX+(z+y),C.maxX),ymax:Math.max(this.connector.bounds.maxY+(z+y),C.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,x);for(var w=0;w<this._jsPlumb.overlays.length;w++){var v=this._jsPlumb.overlays[w];v.isVisible()&&v.paint(this._jsPlumb.overlayPlacements[w],x)}}this._jsPlumb.lastPaintedAt=O}},repaint:function(b){b=b||{},this.paint({elId:this.sourceId,recalc:!(b.recalc===!1),timestamp:b.timestamp})},prepareEndpoint:function(B,A,z,y,x,w,v,u){var t;if(y){z.endpoints[x]=y,y.addConnection(z)}else{w.endpoints||(w.endpoints=[null,null]);var s=w.endpoints[x]||w.endpoint||B.Defaults.Endpoints[x]||jsPlumb.Defaults.Endpoints[x]||B.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;w.endpointStyles||(w.endpointStyles=[null,null]),w.endpointHoverStyles||(w.endpointHoverStyles=[null,null]);var r=w.endpointStyles[x]||w.endpointStyle||B.Defaults.EndpointStyles[x]||jsPlumb.Defaults.EndpointStyles[x]||B.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==r.fillStyle&&null!=w.paintStyle&&(r.fillStyle=w.paintStyle.strokeStyle),null==r.outlineColor&&null!=w.paintStyle&&(r.outlineColor=w.paintStyle.outlineColor),null==r.outlineWidth&&null!=w.paintStyle&&(r.outlineWidth=w.paintStyle.outlineWidth);var q=w.endpointHoverStyles[x]||w.endpointHoverStyle||B.Defaults.EndpointHoverStyles[x]||jsPlumb.Defaults.EndpointHoverStyles[x]||B.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=w.hoverPaintStyle&&(null==q&&(q={}),null==q.fillStyle&&(q.fillStyle=w.hoverPaintStyle.strokeStyle));var p=w.anchors?w.anchors[x]:w.anchor?w.anchor:c(B.Defaults.Anchors[x],u,B)||c(jsPlumb.Defaults.Anchors[x],u,B)||c(B.Defaults.Anchor,u,B)||c(jsPlumb.Defaults.Anchor,u,B),b=w.uuids?w.uuids[x]:null;t=A({paintStyle:r,hoverPaintStyle:q,endpoint:s,connections:[z],uuid:b,anchor:p,source:v,scope:w.scope,reattach:w.reattach||B.Defaults.ReattachConnections,detachable:w.detachable||B.Defaults.ConnectionsDetachable}),z.endpoints[x]=t,w.drawEndpoints===!1&&t.setVisible(!1,!0,!0)}return t}})}(),function(){jsPlumb.AnchorManager=function(R){var Q={},P={},O={},N={},M={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},L=["left","top","right","bottom"],K={},J=this,I={},H=R.jsPlumbInstance,G={},F=function(aa,Z,Y,X,W,V){if(aa===Z){return{orientation:M.IDENTITY,a:["top","top"]}}var U=Math.atan2(X.centery-Y.centery,X.centerx-Y.centerx),T=Math.atan2(Y.centery-X.centery,Y.centerx-X.centerx),S=[],v={};!function(i,h){for(var k=0;k<i.length;k++){v[i[k]]={left:[h[k].left,h[k].centery],right:[h[k].right,h[k].centery],top:[h[k].centerx,h[k].top],bottom:[h[k].centerx,h[k].bottom]}}}(["source","target"],[Y,X]);for(var u=0;u<L.length;u++){for(var t=0;t<L.length;t++){u!=t&&S.push({source:L[u],target:L[t],dist:Biltong.lineLength(v.source[L[u]],v.target[L[t]])})}}S.sort(function(h,c){return h.dist<c.dist?-1:h.dist>c.dist?1:0});for(var s=S[0].source,r=S[0].target,g=0;g<S.length&&(s=!W.isContinuous||W.isEdgeSupported(S[g].source)?S[g].source:null,r=!V.isContinuous||V.isEdgeSupported(S[g].target)?S[g].target:null,null==s||null==r);g++){}return{a:[s,r],theta:U,theta2:T}},E=function(af,ae,ad,ac,ab,aa,Z){for(var Y=[],X=ae[ab?0:1]/(ac.length+1),W=0;W<ac.length;W++){var V=(W+1)*X,U=aa*ae[ab?1:0];Z&&(V=ae[ab?0:1]-V);var T=ab?V:U,S=ad[0]+T,v=T/ae[0],u=ab?U:V,t=ad[1]+u,s=u/ae[1];Y.push([S,t,v,s,ac[W][1],ac[W][2]])}return Y},D=function(b){return function(a,h){var g=!0;return g=b?a[0][0]<h[0][0]:a[0][0]>h[0][0],g===!1?-1:1}},C=function(h,g){var k=h[0][0]<0?-Math.PI-h[0][0]:Math.PI-h[0][0],i=g[0][0]<0?-Math.PI-g[0][0]:Math.PI-g[0][0];return k>i?1:h[0][1]>g[0][1]?1:-1},B={top:function(g,c){return g[0]>c[0]?1:-1},right:D(!0),bottom:D(!0),left:C},A=function(g,c){return g.sort(c)},z=function(i,c){var n=H.getCachedData(i),m=n.s,l=n.o,k=function(Z,Y,X,W,V,U,T){if(W.length>0){for(var S=A(W,B[Z]),v="right"===Z||"top"===Z,r=E(Z,Y,X,S,V,U,v),q=function(h,g){P[h.id]=[g[0],g[1],g[2],g[3]],N[h.id]=T},a=0;a<r.length;a++){var ac=r[a][4],ab=ac.endpoints[0].elementId===i,aa=ac.endpoints[1].elementId===i;ab?q(ac.endpoints[0],r[a]):aa&&q(ac.endpoints[1],r[a])}}};k("bottom",m,[l.left,l.top],c.bottom,!0,1,[0,1]),k("top",m,[l.left,l.top],c.top,!0,0,[0,-1]),k("left",m,[l.left,l.top],c.left,!1,0,[-1,0]),k("right",m,[l.left,l.top],c.right,!1,1,[1,0])};this.reset=function(){Q={},K={},I={}},this.addFloatingConnection=function(g,c){G[g]=c},this.removeFloatingConnection=function(b){delete G[b]},this.newConnection=function(h){var g=h.sourceId,m=h.targetId,l=h.endpoints,k=!0,i=function(o,n,c,b,a){g==m&&c.isContinuous&&(h._jsPlumb.instance.removeElement(l[1].canvas),k=!1),jsPlumbUtil.addToList(K,b,[a,n,c.constructor==jsPlumb.DynamicAnchor])};i(0,l[0],l[0].anchor,m,h),k&&i(1,l[1],l[1].anchor,g,h)};var y=function(b){!function(h,g){if(h){var i=function(c){return c[4]==g};jsPlumbUtil.removeWithFunction(h.top,i),jsPlumbUtil.removeWithFunction(h.left,i),jsPlumbUtil.removeWithFunction(h.bottom,i),jsPlumbUtil.removeWithFunction(h.right,i)}}(I[b.elementId],b.id)};this.connectionDetached=function(h){var g=h.connection||h,m=h.sourceId,l=h.targetId,k=g.endpoints,i=function(o,n,r,q,p){null!=r&&r.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(K[q],function(b){return b[0].id==p.id})};i(1,k[1],k[1].anchor,m,g),i(0,k[0],k[0].anchor,l,g),y(g.endpoints[0]),y(g.endpoints[1]),J.redraw(g.sourceId),J.redraw(g.targetId)},this.add=function(b,g){jsPlumbUtil.addToList(Q,g,b)},this.changeId=function(b,g){K[g]=K[b],Q[g]=Q[b],delete K[b],delete Q[b]},this.getConnectionsFor=function(b){return K[b]||[]},this.getEndpointsFor=function(b){return Q[b]||[]},this.deleteEndpoint=function(b){jsPlumbUtil.removeWithFunction(Q[b.elementId],function(a){return a.id==b.id}),y(b)},this.clearFor=function(b){delete Q[b],Q[b]=[]};var x=function(an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac){var ab,aa=-1,Z=-1,Y=ak.endpoints[ah],X=Y.id,W=[1,0][ah],V=[[am,al],ak,aj,ai,X],U=an[af],T=Y._continuousAnchorEdge?an[Y._continuousAnchorEdge]:null;if(T){var S=jsPlumbUtil.findWithFunction(T,function(b){return b[4]==X});if(-1!=S){for(T.splice(S,1),ab=0;ab<T.length;ab++){jsPlumbUtil.addWithFunction(ad,T[ab][1],function(b){return b.id==T[ab][1].id}),jsPlumbUtil.addWithFunction(ac,T[ab][1].endpoints[ah],function(b){return b.id==T[ab][1].endpoints[ah].id}),jsPlumbUtil.addWithFunction(ac,T[ab][1].endpoints[W],function(b){return b.id==T[ab][1].endpoints[W].id})}}}for(ab=0;ab<U.length;ab++){1==R.idx&&U[ab][3]===ai&&-1==Z&&(Z=ab),jsPlumbUtil.addWithFunction(ad,U[ab][1],function(b){return b.id==U[ab][1].id}),jsPlumbUtil.addWithFunction(ac,U[ab][1].endpoints[ah],function(b){return b.id==U[ab][1].endpoints[ah].id}),jsPlumbUtil.addWithFunction(ac,U[ab][1].endpoints[W],function(b){return b.id==U[ab][1].endpoints[W].id})}if(-1!=aa){U[aa]=V}else{var a=ag?-1!=Z?Z:0:U.length;U.splice(a,0,V)}Y._continuousAnchorEdge=af};this.updateOtherEndpoint=function(h,g,m,l){var k=jsPlumbUtil.findWithFunction(K[h],function(b){return b[0].id===l.id}),i=jsPlumbUtil.findWithFunction(K[g],function(b){return b[0].id===l.id});-1!=k&&(K[h][k][0]=l,K[h][k][1]=l.endpoints[1],K[h][k][2]=l.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor),i>-1&&(K[g].splice(i,1),jsPlumbUtil.addToList(K,m,[l,l.endpoints[0],l.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor]))},this.sourceChanged=function(h,g,k){if(h!==g){jsPlumbUtil.removeWithFunction(K[h],function(b){return b[0].id===k.id});var i=jsPlumbUtil.findWithFunction(K[k.targetId],function(b){return b[0].id===k.id});i>-1&&(K[k.targetId][i][0]=k,K[k.targetId][i][1]=k.endpoints[0],K[k.targetId][i][2]=k.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor),jsPlumbUtil.addToList(K,g,[k,k.endpoints[1],k.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])}},this.rehomeEndpoint=function(b,p,o){var n=Q[p]||[],m=H.getId(o);if(m!==p){var l=jsPlumbUtil.indexOf(n,b);if(l>-1){var k=n.splice(l,1)[0];J.add(k,m)}}for(var i=0;i<b.connections.length;i++){b.connections[i].sourceId==p?(b.connections[i].sourceId=b.elementId,b.connections[i].source=b.element,J.sourceChanged(p,b.elementId,b.connections[i])):b.connections[i].targetId==p&&(b.connections[i].targetId=b.elementId,b.connections[i].target=b.element,J.updateOtherEndpoint(b.connections[i].sourceId,p,b.elementId,b.connections[i]))}},this.redraw=function(am,al,ak,aj,ai,ah){if(!H.isSuspendDrawing()){var ag=Q[am]||[],af=K[am]||[],ae=[],ad=[],ab=[];ak=ak||H.timestamp(),aj=aj||{left:0,top:0},al&&(al={left:al.left+aj.left,top:al.top+aj.top});for(var Z=H.updateOffset({elId:am,offset:al,recalc:!1,timestamp:ak}),W={},T=0;T<af.length;T++){var u=af[T][0],m=u.sourceId,k=u.targetId,b=u.endpoints[0].anchor.isContinuous,ac=u.endpoints[1].anchor.isContinuous;if(b||ac){var aa=m+"_"+k,Y=W[aa],X=u.sourceId==am?1:0;b&&!I[m]&&(I[m]={top:[],right:[],bottom:[],left:[]}),ac&&!I[k]&&(I[k]={top:[],right:[],bottom:[],left:[]}),am!=k&&H.updateOffset({elId:k,timestamp:ak}),am!=m&&H.updateOffset({elId:m,timestamp:ak});var V=H.getCachedData(k),U=H.getCachedData(m);k==m&&(b||ac)?x(I[m],-Math.PI/2,0,u,!1,k,0,!1,"top",m,ae,ad):(Y||(Y=F(m,k,U.o,V.o,u.endpoints[0].anchor,u.endpoints[1].anchor),W[aa]=Y),b&&x(I[m],Y.theta,0,u,!1,k,0,!1,Y.a[0],m,ae,ad),ac&&x(I[k],Y.theta2,-1,u,!0,m,1,!0,Y.a[1],k,ae,ad)),b&&jsPlumbUtil.addWithFunction(ab,m,function(c){return c===m}),ac&&jsPlumbUtil.addWithFunction(ab,k,function(c){return c===k}),jsPlumbUtil.addWithFunction(ae,u,function(c){return c.id==u.id}),(b&&0===X||ac&&1===X)&&jsPlumbUtil.addWithFunction(ad,u.endpoints[X],function(c){return c.id==u.endpoints[X].id})}}for(T=0;T<ag.length;T++){0===ag[T].connections.length&&ag[T].anchor.isContinuous&&(I[am]||(I[am]={top:[],right:[],bottom:[],left:[]}),x(I[am],-Math.PI/2,0,{endpoints:[ag[T],ag[T]],paint:function(){}},!1,am,0,!1,ag[T].anchor.getDefaultFace(),am,ae,ad),jsPlumbUtil.addWithFunction(ab,am,function(a){return a===am}))}for(T=0;T<ab.length;T++){z(ab[T],I[ab[T]])}for(T=0;T<ag.length;T++){ag[T].paint({timestamp:ak,offset:Z,dimensions:Z.s,recalc:ah!==!0})}for(T=0;T<ad.length;T++){var S=H.getCachedData(ad[T].elementId);ad[T].paint({timestamp:ak,offset:S,dimensions:S.s})}for(T=0;T<af.length;T++){var s=af[T][1];if(s.anchor.constructor==jsPlumb.DynamicAnchor){s.paint({elementWithPrecedence:am,timestamp:ak}),jsPlumbUtil.addWithFunction(ae,af[T][0],function(c){return c.id==af[T][0].id});for(var l=0;l<s.connections.length;l++){s.connections[l]!==af[T][0]&&jsPlumbUtil.addWithFunction(ae,s.connections[l],function(c){return c.id==s.connections[l].id})}}else{s.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(ae,af[T][0],function(c){return c.id==af[T][0].id})}}var h=G[am];for(h&&h.paint({timestamp:ak,recalc:!1,elId:am}),T=0;T<ae.length;T++){ae[T].paint({elId:am,timestamp:ak,recalc:!1,clearEdits:ai})}}};var w=function(T){jsPlumbUtil.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var S=T.faces||["top","right","bottom","left"],v=!(T.clockwise===!1),u={},t={top:"bottom",right:"left",left:"right",bottom:"top"},s={top:"right",right:"bottom",left:"top",bottom:"left"},r={top:"left",right:"top",left:"bottom",bottom:"right"},q=v?s:r,p=v?r:s,o=T.cssClass||"",c=0;c<S.length;c++){u[S[c]]=!0}this.getDefaultFace=function(){return 0===S.length?"top":S[0]},this.verifyEdge=function(b){return u[b]?b:u[t[b]]?t[b]:u[q[b]]?q[b]:u[p[b]]?p[b]:b},this.isEdgeSupported=function(b){return u[b]===!0},this.compute=function(b){return O[b.element.id]||P[b.element.id]||[0,0]},this.getCurrentLocation=function(b){return O[b.element.id]||P[b.element.id]||[0,0]},this.getOrientation=function(b){return N[b.id]||[0,0]},this.clearUserDefinedLocation=function(){delete O[T.elementId]},this.setUserDefinedLocation=function(a){O[T.elementId]=a},this.getCssClass=function(){return o},this.setCssClass=function(b){o=b}};H.continuousAnchorFactory={get:function(b){return new w(b)},clear:function(b){delete O[b],delete P[b]}}},jsPlumb.Anchor=function(b){this.x=b.x||0,this.y=b.y||0,this.elementId=b.elementId,this.cssClass=b.cssClass||"",this.userDefinedLocation=null,this.orientation=b.orientation||[0,0],jsPlumbUtil.EventGenerator.apply(this),b.jsPlumbInstance,this.lastReturnValue=null,this.offsets=b.offsets||[0,0],this.timestamp=null,this.compute=function(h){var g=h.xy,k=h.wh,i=(h.element,h.timestamp);return h.clearUserDefinedLocation&&(this.userDefinedLocation=null),i&&i===self.timestamp?this.lastReturnValue:(this.lastReturnValue=null!=this.userDefinedLocation?this.userDefinedLocation:[g[0]+this.x*k[0]+this.offsets[0],g[1]+this.y*k[1]+this.offsets[1]],this.timestamp=i,this.lastReturnValue)},this.getCurrentLocation=function(c){return null==this.lastReturnValue||null!=c.timestamp&&this.timestamp!=c.timestamp?this.compute(c):this.lastReturnValue}},jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(h){if(!h){return !1}var g=h.getOrientation(),i=this.getOrientation();return this.x==h.x&&this.y==h.y&&this.offsets[0]==h.offsets[0]&&this.offsets[1]==h.offsets[1]&&i[0]==g[0]&&i[1]==g[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(b){this.userDefinedLocation=b},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),jsPlumb.FloatingAnchor=function(k){jsPlumb.Anchor.apply(this,arguments);var i=k.reference,q=(k.jsPlumbInstance,k.referenceCanvas),p=jsPlumb.getSize(q),o=0,n=0,m=null,l=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(h){var g=h.xy,r=(h.element,[g[0]+p[0]/2,g[1]+p[1]/2]);return l=r,r},this.getOrientation=function(b){if(m){return m}var g=i.getOrientation(b);return[-1*Math.abs(g[0])*o,-1*Math.abs(g[1])*n]},this.over=function(g,c){m=g.getOrientation(c)},this.out=function(){m=null},this.getCurrentLocation=function(b){return null==l?this.compute(b):l}},jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);var e=function(h,g,i){return h.constructor==jsPlumb.Anchor?h:g.makeAnchor(h,i,g)};jsPlumb.DynamicAnchor=function(a){jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0,this.anchors=[],this.elementId=a.elementId,this.jsPlumbInstance=a.jsPlumbInstance;for(var o=0;o<a.anchors.length;o++){this.anchors[o]=e(a.anchors[o],this.jsPlumbInstance,this.elementId)}this.addAnchor=function(c){this.anchors.push(e(c,this.jsPlumbInstance,this.elementId))},this.getAnchors=function(){return this.anchors},this.locked=!1;var n=this.anchors.length>0?this.anchors[0]:null,m=(this.anchors.length>0?0:-1,n),l=this,k=function(x,w,v,u,t){var s=u[0]+x.x*t[0],r=u[1]+x.y*t[1],q=u[0]+t[0]/2,p=u[1]+t[1]/2;return Math.sqrt(Math.pow(w-s,2)+Math.pow(v-r,2))+Math.sqrt(Math.pow(q-s,2)+Math.pow(p-r,2))},i=a.selector||function(y,x,w,v,u){for(var t=w[0]+v[0]/2,s=w[1]+v[1]/2,r=-1,q=1/0,p=0;p<u.length;p++){var g=k(u[p],t,s,y,x);q>g&&(r=p+0,q=g)}return u[r]};this.compute=function(p){var h=p.xy,u=p.wh,t=p.timestamp,s=p.txy,r=p.twh;this.timestamp=t;var q=l.getUserDefinedLocation();return null!=q?q:this.locked||null==s||null==r?n.compute(p):(p.timestamp=null,n=i(h,u,s,r,this.anchors),this.x=n.x,this.y=n.y,n!=m&&this.fire("anchorChanged",n),m=n,n.compute(p))},this.getCurrentLocation=function(b){return this.getUserDefinedLocation()||(null!=n?n.getCurrentLocation(b):null)},this.getOrientation=function(b){return null!=n?n.getOrientation(b):[0,0]},this.over=function(g,c){null!=n&&n.over(g,c)},this.out=function(){null!=n&&n.out()},this.getCssClass=function(){return n&&n.getCssClass()||""}},jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);var d=function(h,g,m,l,k,i){jsPlumb.Anchors[k]=function(b){var a=b.jsPlumbInstance.makeAnchor([h,g,m,l,0,0],b.elementId,b.jsPlumbInstance);return a.type=k,i&&i(a,b),a}};d(0.5,0,0,-1,"TopCenter"),d(0.5,1,0,1,"BottomCenter"),d(0,0.5,-1,0,"LeftMiddle"),d(1,0.5,1,0,"RightMiddle"),d(0.5,0,0,-1,"Top"),d(0.5,1,0,1,"Bottom"),d(0,0.5,-1,0,"Left"),d(1,0.5,1,0,"Right"),d(0.5,0.5,0,0,"Center"),d(1,0,0,-1,"TopRight"),d(1,1,0,1,"BottomRight"),d(0,0,0,-1,"TopLeft"),d(0,1,0,1,"BottomLeft"),jsPlumb.Defaults.DynamicAnchors=function(b){return b.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],b.elementId,b.jsPlumbInstance)},jsPlumb.Anchors.AutoDefault=function(g){var c=g.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(g));return c.type="AutoDefault",c};var f=function(g,c){jsPlumb.Anchors[g]=function(b){var a=b.jsPlumbInstance.makeAnchor(["Continuous",{faces:c}],b.elementId,b.jsPlumbInstance);return a.type=g,a}};jsPlumb.Anchors.Continuous=function(b){return b.jsPlumbInstance.continuousAnchorFactory.get(b)},f("ContinuousLeft",["left"]),f("ContinuousTop",["top"]),f("ContinuousBottom",["bottom"]),f("ContinuousRight",["right"]),d(0,0,0,0,"Assign",function(h,g){var i=g.position||"Fixed";h.positionFinder=i.constructor==String?g.jsPlumbInstance.AnchorPositionFinders[i]:i,h.constructorParams=g}),jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(h,g,i){return[(h.left-g.left)/i[0],(h.top-g.top)/i[1]]},Grid:function(t,s,r,q){var p=t.left-s.left,o=t.top-s.top,n=r[0]/q.grid[0],m=r[1]/q.grid[1],l=Math.floor(p/n),k=Math.floor(o/m);return[(l*n+n/2)/r[0],(k*m+m/2)/r[1]]}},jsPlumb.Anchors.Perimeter=function(v){v=v||{};var u=v.anchorCount||60,t=v.shape;if(!t){throw new Error("no shape supplied to Perimeter Anchor type")}var s=function(){for(var b=0.5,z=2*Math.PI/u,y=0,x=[],w=0;u>w;w++){var k=b+b*Math.sin(y),i=b+b*Math.cos(y);x.push([k,i,0,0]),y+=z}return x},r=function(b){for(var k=u/b.length,i=[],h=function(c,C,B,A,z){k=u*z;for(var y=(B-c)/k,x=(A-C)/k,w=0;k>w;w++){i.push([c+y*w,C+x*w,0,0])}},g=0;g<b.length;g++){h.apply(null,b[g])}return i},q=function(h){for(var g=[],i=0;i<h.length;i++){g.push([h[i][0],h[i][1],h[i][2],h[i][3],1/h.length])}return r(g)},p=function(){return q([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},o={Circle:s,Ellipse:s,Diamond:function(){return q([[0.5,0,1,0.5],[1,0.5,0.5,1],[0.5,1,0,0.5],[0,0.5,0.5,0]])},Rectangle:p,Square:p,Triangle:function(){return q([[0.5,0,1,1],[1,1,0,1],[0,1,0.5,0]])},Path:function(k){for(var i=k.points,A=[],z=0,y=0;y<i.length-1;y++){var x=Math.sqrt(Math.pow(i[y][2]-i[y][0])+Math.pow(i[y][3]-i[y][1]));z+=x,A.push([i[y][0],i[y][1],i[y+1][0],i[y+1][1],x])}for(var w=0;w<A.length;w++){A[w][4]=A[w][4]/z}return r(A)}},n=function(i,h){for(var z=[],y=h/180*Math.PI,x=0;x<i.length;x++){var w=i[x][0]-0.5,k=i[x][1]-0.5;z.push([0.5+(w*Math.cos(y)-k*Math.sin(y)),0.5+(w*Math.sin(y)+k*Math.cos(y)),i[x][2],i[x][3]])}return z};if(!o[t]){throw new Error("Shape ["+t+"] is unknown by Perimeter Anchor type")}var m=o[t](v);v.rotation&&(m=n(m,v.rotation));var l=v.jsPlumbInstance.makeDynamicAnchor(m);return l.type="Perimeter",l}}(),function(){jsPlumb.Segments={AbstractSegment:function(b){this.params=b,this.findClosestPointOnPath=function(){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(b.x1,b.x2),minY:Math.min(b.y1,b.y2),maxX:Math.max(b.x1,b.x2),maxY:Math.max(b.y1,b.y2)}}},Straight:function(x){var w,v,u,t,s,r,q,p=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(){w=Math.sqrt(Math.pow(s-t,2)+Math.pow(q-r,2)),v=Biltong.gradient({x:t,y:r},{x:s,y:q}),u=-1/v});this.type="Straight",this.getLength=function(){return w},this.getGradient=function(){return v},this.getCoordinates=function(){return{x1:t,y1:r,x2:s,y2:q}},this.setCoordinates=function(b){t=b.x1,r=b.y1,s=b.x2,q=b.y2,p()},this.setCoordinates({x1:x.x1,y1:x.y1,x2:x.x2,y2:x.y2}),this.getBounds=function(){return{minX:Math.min(t,s),minY:Math.min(r,q),maxX:Math.max(t,s),maxY:Math.max(r,q)}},this.pointOnPath=function(b,f){if(0!==b||f){if(1!=b||f){var e=f?b>0?b:w+b:b*w;return Biltong.pointOnLine({x:t,y:r},{x:s,y:q},e)}return{x:s,y:q}}return{x:t,y:r}},this.gradientAtPoint=function(){return v},this.pointAlongPathFrom=function(f,e,A){var z=this.pointOnPath(f,A),y=0>=e?{x:t,y:r}:{x:s,y:q};return 0>=e&&Math.abs(e)>1&&(e*=-1),Biltong.pointOnLine(z,y,e)};var o=function(e,d,f){return f>=Math.min(e,d)&&f<=Math.max(e,d)},n=function(e,d,f){return Math.abs(f-e)<Math.abs(f-d)?e:d};this.findClosestPointOnPath=function(d,e){var c={d:1/0,x:null,y:null,l:null,x1:t,x2:s,y1:r,y2:q};if(0===v){c.y=r,c.x=o(t,s,d)?d:n(t,s,d)}else{if(1/0==v||v==-1/0){c.x=t,c.y=o(r,q,e)?e:n(r,q,e)}else{var b=r-v*t,A=e-u*d,z=(A-b)/(v-u),y=v*z+b;c.x=o(t,s,z)?z:n(t,s,z),c.y=o(r,q,y)?y:n(r,q,y)}}var f=Biltong.lineLength([c.x,c.y],[t,r]);return c.d=Biltong.lineLength([d,e],[c.x,c.y]),c.l=f/w,c}},Arc:function(w){var v=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(a,d){return Biltong.theta([w.cx,w.cy],[a,d])}),u=function(x,d){if(x.anticlockwise){var B=x.startAngle<x.endAngle?x.startAngle+t:x.startAngle,A=Math.abs(B-x.endAngle);return B-A*d}var z=x.endAngle<x.startAngle?x.endAngle+t:x.endAngle,y=Math.abs(z-x.startAngle);return x.startAngle+y*d},t=2*Math.PI;this.radius=w.r,this.anticlockwise=w.ac,this.type="Arc",w.startAngle&&w.endAngle?(this.startAngle=w.startAngle,this.endAngle=w.endAngle,this.x1=w.cx+this.radius*Math.cos(w.startAngle),this.y1=w.cy+this.radius*Math.sin(w.startAngle),this.x2=w.cx+this.radius*Math.cos(w.endAngle),this.y2=w.cy+this.radius*Math.sin(w.endAngle)):(this.startAngle=v(w.x1,w.y1),this.endAngle=v(w.x2,w.y2),this.x1=w.x1,this.y1=w.y1,this.x2=w.x2,this.y2=w.y2),this.endAngle<0&&(this.endAngle+=t),this.startAngle<0&&(this.startAngle+=t),this.segment=Biltong.quadrant([this.x1,this.y1],[this.x2,this.y2]);var s=this.endAngle<this.startAngle?this.endAngle+t:this.endAngle;this.sweep=Math.abs(s-this.startAngle),this.anticlockwise&&(this.sweep=t-this.sweep);var r=2*Math.PI*this.radius,q=this.sweep/t,p=r*q;this.getLength=function(){return p},this.getBounds=function(){return{minX:w.cx-w.r,maxX:w.cx+w.r,minY:w.cy-w.r,maxY:w.cy+w.r}};var o=1e-10,n=function(e){var d=Math.floor(e),f=Math.ceil(e);return o>e-d?d:o>f-e?f:e};this.pointOnPath=function(a,z){if(0===a){return{x:this.x1,y:this.y1,theta:this.startAngle}}if(1==a){return{x:this.x2,y:this.y2,theta:this.endAngle}}z&&(a/=p);var y=u(this,a),x=w.cx+w.r*Math.cos(y),c=w.cy+w.r*Math.sin(y);return{x:n(x),y:n(c),theta:y}},this.gradientAtPoint=function(a,y){var x=this.pointOnPath(a,y),f=Biltong.normal([w.cx,w.cy],[x.x,x.y]);return this.anticlockwise||1/0!=f&&f!=-1/0||(f*=-1),f},this.pointAlongPathFrom=function(D,C,B){var A=this.pointOnPath(D,B),z=2*(C/r)*Math.PI,y=this.anticlockwise?-1:1,x=A.theta+y*z,f=w.cx+this.radius*Math.cos(x),a=w.cy+this.radius*Math.sin(x);return{x:f,y:a}}},Bezier:function(d){this.curve=[{x:d.x1,y:d.y1},{x:d.cp1x,y:d.cp1y},{x:d.cp2x,y:d.cp2y},{x:d.x2,y:d.y2}],jsPlumb.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(d.x1,d.x2,d.cp1x,d.cp2x),minY:Math.min(d.y1,d.y2,d.cp1y,d.cp2y),maxX:Math.max(d.x1,d.x2,d.cp1x,d.cp2x),maxY:Math.max(d.y1,d.y2,d.cp1y,d.cp2y)},this.type="Bezier";var c=function(f,e,n){return n&&(e=jsBezier.locationAlongCurveFrom(f,e>0?0:1,e)),e};this.pointOnPath=function(b,e){return b=c(this.curve,b,e),jsBezier.pointOnCurve(this.curve,b)},this.gradientAtPoint=function(b,e){return b=c(this.curve,b,e),jsBezier.gradientAtPoint(this.curve,b)},this.pointAlongPathFrom=function(b,f,e){return b=c(this.curve,b,e),jsBezier.pointAlongCurveFrom(this.curve,b,f)},this.getLength=function(){return jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds}}};var h=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(L){h.apply(this,arguments);var K=[],J=0,I=[],H=[],G=L.stub||0,F=jsPlumbUtil.isArray(G)?G[0]:G,E=jsPlumbUtil.isArray(G)?G[1]:G,D=L.gap||0,C=jsPlumbUtil.isArray(D)?D[0]:D,B=jsPlumbUtil.isArray(D)?D[1]:D,A=null,z=!1,y=null;this.getPath=function(){},this.setPath=function(){},this.findSegmentForPoint=function(n,c){for(var q={d:1/0,s:null,x:null,y:null,l:null},p=0;p<K.length;p++){var o=K[p].findClosestPointOnPath(n,c);o.d<q.d&&(q.d=o.d,q.l=o.l,q.x=o.x,q.y=o.y,q.s=K[p],q.x1=o.x1,q.x2=o.x2,q.y1=o.y1,q.y2=o.y2,q.index=p)}return q};var x=function(){for(var d=0,c=0;c<K.length;c++){var e=K[c].getLength();H[c]=e/J,I[c]=[d,d+=e/J]}},w=function(d,c){c&&(d=d>0?d/J:(J+d)/J);for(var n=I.length-1,f=1,e=0;e<I.length;e++){if(I[e][1]>=d){n=e,f=1==d?1:0===d?0:(d-I[e][0])/H[e];break}}return{segment:K[n],proportion:f,index:n}},v=function(d,c,o){if(o.x1!=o.x2||o.y1!=o.y2){var n=new jsPlumb.Segments[c](o);K.push(n),J+=n.getLength(),d.updateBounds(n)}},u=function(){J=K.length=I.length=H.length=0};this.setSegments=function(d){A=[],J=0;for(var c=0;c<d.length;c++){A.push(d[c]),J+=d[c].getLength()}};var a=function(ae){this.lineWidth=ae.lineWidth;var ad=Biltong.quadrant(ae.sourcePos,ae.targetPos),ac=ae.targetPos[0]<ae.sourcePos[0],ab=ae.targetPos[1]<ae.sourcePos[1],aa=ae.lineWidth||1,Z=ae.sourceEndpoint.anchor.getOrientation(ae.sourceEndpoint),Y=ae.targetEndpoint.anchor.getOrientation(ae.targetEndpoint),X=ac?ae.targetPos[0]:ae.sourcePos[0],W=ab?ae.targetPos[1]:ae.sourcePos[1],V=Math.abs(ae.targetPos[0]-ae.sourcePos[0]),U=Math.abs(ae.targetPos[1]-ae.sourcePos[1]);if(0===Z[0]&&0===Z[1]||0===Y[0]&&0===Y[1]){var T=V>U?0:1,S=[1,0][T];Z=[],Y=[],Z[T]=ae.sourcePos[T]>ae.targetPos[T]?-1:1,Y[T]=ae.sourcePos[T]>ae.targetPos[T]?1:-1,Z[S]=0,Y[S]=0}var R=ac?V+C*Z[0]:C*Z[0],Q=ab?U+C*Z[1]:C*Z[1],P=ac?B*Y[0]:V+B*Y[0],O=ab?B*Y[1]:U+B*Y[1],N=Z[0]*Y[0]+Z[1]*Y[1],M={sx:R,sy:Q,tx:P,ty:O,lw:aa,xSpan:Math.abs(P-R),ySpan:Math.abs(O-Q),mx:(R+P)/2,my:(Q+O)/2,so:Z,to:Y,x:X,y:W,w:V,h:U,segment:ad,startStubX:R+Z[0]*F,startStubY:Q+Z[1]*F,endStubX:P+Y[0]*E,endStubY:O+Y[1]*E,isXGreaterThanStubTimes2:Math.abs(R-P)>F+E,isYGreaterThanStubTimes2:Math.abs(Q-O)>F+E,opposite:-1==N,perpendicular:0===N,orthogonal:1==N,sourceAxis:0===Z[0]?"y":"x",points:[X,W,V,U,R,Q,P,O]};return M.anchorOrientation=M.opposite?"opposite":M.orthogonal?"orthogonal":"perpendicular",M};return this.getSegments=function(){return K},this.updateBounds=function(d){var c=d.getBounds();this.bounds.minX=Math.min(this.bounds.minX,c.minX),this.bounds.maxX=Math.max(this.bounds.maxX,c.maxX),this.bounds.minY=Math.min(this.bounds.minY,c.minY),this.bounds.maxY=Math.max(this.bounds.maxY,c.maxY)},this.pointOnPath=function(e,d){var f=w(e,d);return f.segment&&f.segment.pointOnPath(f.proportion,!1)||[0,0]},this.gradientAtPoint=function(e,d){var f=w(e,d);return f.segment&&f.segment.gradientAtPoint(f.proportion,!1)||0},this.pointAlongPathFrom=function(f,e,o){var n=w(f,o);return n.segment&&n.segment.pointAlongPathFrom(n.proportion,e,!1)||[0,0]},this.compute=function(b){z||(y=a.call(this,b)),u(),this._compute(y,b),this.x=y.points[0],this.y=y.points[1],this.w=y.points[2],this.h=y.points[3],this.segment=y.segment,x()},{addSegment:v,prepareCompute:a,sourceStub:F,targetStub:E,maxStub:Math.max(F,E),sourceGap:C,targetGap:B,maxGap:Math.max(C,B)}},jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,h);var g=jsPlumb.Connectors.Straight=function(){this.type="Straight";var b=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(a){b.addSegment(this,"Straight",{x1:a.sx,y1:a.sy,x2:a.startStubX,y2:a.startStubY}),b.addSegment(this,"Straight",{x1:a.startStubX,y1:a.startStubY,x2:a.endStubX,y2:a.endStubY}),b.addSegment(this,"Straight",{x1:a.endStubX,y1:a.endStubY,x2:a.tx,y2:a.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(g,"Straight"),jsPlumb.Endpoints.AbstractEndpoint=function(a){h.apply(this,arguments);var d=this.compute=function(){var b=this._compute.apply(this,arguments);return this.x=b[0],this.y=b[1],this.w=b[2],this.h=b[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,b};return{compute:d,cssClass:a.cssClass}},jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,h),jsPlumb.Endpoints.Dot=function(b){this.type="Dot",jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),b=b||{},this.radius=b.radius||10,this.defaultOffset=0.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(o,n,u){this.radius=u.radius||this.radius;var t=o[0]-this.radius,s=o[1]-this.radius,r=2*this.radius,q=2*this.radius;if(u.strokeStyle){var p=u.lineWidth||1;t-=p,s-=p,r+=2*p,q+=2*p}return[t,s,r,q,this.radius]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint),jsPlumb.Endpoints.Rectangle=function(b){this.type="Rectangle",jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),b=b||{},this.width=b.width||20,this.height=b.height||20,this._compute=function(o,n,t){var s=t.width||this.width,r=t.height||this.height,q=o[0]-s/2,p=o[1]-r/2;return[q,p,s,r]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);var m=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(m,jsPlumb.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(b){this._jsPlumb.displayElements.push(b)}}),jsPlumb.Endpoints.Image=function(f){this.type="Image",m.apply(this,arguments),jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var c=f.onload,o=f.src||f.url,n=f.cssClass?" "+f.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=f.width,this._jsPlumb.heightToUse=f.height,this._jsPlumb.endpoint=f.endpoint,this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,c&&c(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(b,p){var e=b.constructor==String?b:b.src;c=p,this._jsPlumb.img.src=e,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(o,c),this._compute=function(b){return this.anchorPoint=b,this._jsPlumb.ready?[b[0]-this._jsPlumb.widthToUse/2,b[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=document.createElement("img"),this.canvas.style.margin=0,this.canvas.style.padding=0,this.canvas.style.outline=0,this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.instance.endpointClass+n,this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var e=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,d=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;jsPlumbUtil.sizeElement(this.canvas,e,d,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(e,d){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(e,d):window.setTimeout(function(){this.paint(e,d)}.bind(this),200))}},jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[m,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null}}),jsPlumb.Endpoints.Blank=function(d){jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",m.apply(this,arguments),this._compute=function(b){return[b[0],b[1],10,0]};var c=d.cssClass?" "+d.cssClass:"";this.canvas=document.createElement("div"),this.canvas.style.display="block",this.canvas.style.width="1px",this.canvas.style.height="1px",this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.instance.endpointClass+c,this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,m],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),jsPlumb.Endpoints.Triangle=function(b){this.type="Triangle",jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),b=b||{},b.width=b.width||55,b.height=b.height||55,this.width=b.width,this.height=b.height,this._compute=function(o,n,t){var s=t.width||self.width,r=t.height||self.height,q=o[0]-s/2,p=o[1]-r/2;return[q,p,s,r]}};var l=jsPlumb.Overlays.AbstractOverlay=function(b){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=b.component,this.loc=null==b.location?0.5:b.location,this.endpointLoc=null==b.endpointLocation?[0.5,0.5]:b.endpointLocation};l.prototype={cleanup:function(){this.component=null,this.canvas=null,this.endpointLoc=null},setVisible:function(b){this.visible=b,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(b){this.loc+=b,this.component.repaint()},setLocation:function(b){this.loc=b,this.component.repaint()},getLocation:function(){return this.loc}},jsPlumb.Overlays.Arrow=function(n){this.type="Arrow",l.apply(this,arguments),this.isAppendedAtTopLevel=!1,n=n||{};var d=jsPlumbUtil,r=Biltong;this.length=n.length||20,this.width=n.width||20,this.id=n.id;var q=(n.direction||1)<0?-1:1,p=n.paintStyle||{lineWidth:1},o=n.foldback||0.623;this.computeMaxSize=function(){return 1.5*self.width},this.draw=function(C,B){var A,z,y,x,w;if(C.pointAlongPathFrom){if(d.isString(this.loc)||this.loc>1||this.loc<0){var v=parseInt(this.loc,10),u=this.loc<0?1:0;A=C.pointAlongPathFrom(u,v,!1),z=C.pointAlongPathFrom(u,v-q*this.length/2,!1),y=r.pointOnLine(A,z,this.length)}else{if(1==this.loc){if(A=C.pointOnPath(this.loc),z=C.pointAlongPathFrom(this.loc,-this.length),y=r.pointOnLine(A,z,this.length),-1==q){var f=y;y=A,A=f}}else{if(0===this.loc){if(y=C.pointOnPath(this.loc),z=C.pointAlongPathFrom(this.loc,this.length),A=r.pointOnLine(y,z,this.length),-1==q){var e=y;y=A,A=e}}else{A=C.pointAlongPathFrom(this.loc,q*this.length/2),z=C.pointOnPath(this.loc),y=r.pointOnLine(A,z,this.length)}}}x=r.perpendicularLineTo(A,y,this.width),w=r.pointOnLine(A,y,o*this.length);var c={hxy:A,tail:x,cxy:w},b=p.strokeStyle||B.strokeStyle,E=p.fillStyle||B.strokeStyle,D=p.lineWidth||B.lineWidth;return{component:C,d:c,lineWidth:D,strokeStyle:b,fillStyle:E,minX:Math.min(A.x,x[0].x,x[1].x),maxX:Math.max(A.x,x[0].x,x[1].x),minY:Math.min(A.y,x[0].y,x[1].y),maxY:Math.max(A.y,x[0].y,x[1].y)}}return{component:C,minX:0,maxX:0,minY:0,maxY:0}}},jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,l),jsPlumb.Overlays.PlainArrow=function(d){d=d||{};var c=jsPlumb.extend(d,{foldback:1});jsPlumb.Overlays.Arrow.call(this,c),this.type="PlainArrow"},jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow),jsPlumb.Overlays.Diamond=function(e){e=e||{};var d=e.length||40,f=jsPlumb.extend(e,{length:d/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,f),this.type="Diamond"},jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);var k=function(d,c){return(null==d._jsPlumb.cachedDimensions||c)&&(d._jsPlumb.cachedDimensions=d.getDimensions()),d._jsPlumb.cachedDimensions},i=function(d){jsPlumb.jsPlumbUIComponent.apply(this,arguments),l.apply(this,arguments);var c=this.fire;this.fire=function(){c.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.id=d.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=d.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=d.create,this._jsPlumb.initiallyInvisible=d.visible===!1,this.getElement=function(){if(null==this._jsPlumb.div){var a=this._jsPlumb.div=jsPlumb.getDOMElement(this._jsPlumb.create(this._jsPlumb.component));a.style.position="absolute",a.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:d.cssClass?d.cssClass:""),this._jsPlumb.instance.appendElement(a),this._jsPlumb.instance.getId(a),this.canvas=a;var e="translate(-50%, -50%)";a.style.webkitTransform=e,a.style.mozTransform=e,a.style.msTransform=e,a.style.oTransform=e,a.style.transform=e,a._jsPlumb=this,d.visible===!1&&(a.style.display="none")}return this._jsPlumb.div},this.draw=function(v,u,t){var s=k(this);if(null!=s&&2==s.length){var r={x:0,y:0};if(t){r={x:t[0],y:t[1]}}else{if(v.pointOnPath){var q=this.loc,p=!1;(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1)&&(q=parseInt(this.loc,10),p=!0),r=v.pointOnPath(q,p)}else{var o=this.loc.constructor==Array?this.loc:this.endpointLoc;r={x:o[0]*v.w,y:o[1]*v.h}}}var n=r.x-s[0]/2,e=r.y-s[1]/2;return{component:v,d:{minx:n,miny:e,td:s,cxy:r},minX:n,maxX:n+s[0],minY:e,maxY:e+s[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(i,[jsPlumb.jsPlumbUIComponent,l],{getDimensions:function(){return jsPlumbUtil.oldIE?jsPlumb.getSize(this.getElement()):[1,1]},setVisible:function(b){this._jsPlumb.div.style.display=b?"block":"none",b&&this._jsPlumb.initiallyInvisible&&(k(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1)},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div))},computeMaxSize:function(){var b=k(this);return Math.max(b[0],b[1])},paint:function(b){this._jsPlumb.initialised||(this.getElement(),b.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0),this._jsPlumb.div.style.left=b.component.x+b.d.minx+"px",this._jsPlumb.div.style.top=b.component.y+b.d.miny+"px"}}),jsPlumb.Overlays.Custom=function(){this.type="Custom",i.apply(this,arguments)},jsPlumbUtil.extend(jsPlumb.Overlays.Custom,i),jsPlumb.Overlays.GuideLines=function(){var b=this;b.length=50,b.lineWidth=5,this.type="GuideLines",l.apply(this,arguments),jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.draw=function(a){var r=a.pointAlongPathFrom(b.loc,b.length/2),q=a.pointOnPath(b.loc),p=Biltong.pointOnLine(r,q,b.length),o=Biltong.perpendicularLineTo(r,p,40),n=Biltong.perpendicularLineTo(p,r,20);return{connector:a,head:r,tail:p,headLine:n,tailLine:o,minX:Math.min(r.x,p.x,n[0].x,n[1].x),minY:Math.min(r.y,p.y,n[0].y,n[1].y),maxX:Math.max(r.x,p.x,n[0].x,n[1].x),maxY:Math.max(r.y,p.y,n[0].y,n[1].y)}}},jsPlumb.Overlays.Label=function(f){this.labelStyle=f.labelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var e=jsPlumb.extend({create:function(){return document.createElement("div")}},f);if(jsPlumb.Overlays.Custom.call(this,e),this.type="Label",this.label=f.label||"",this.labelText=null,this.labelStyle){var o=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",o.style.font=this.labelStyle.font,o.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(o.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0){var n=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";o.style.border=this.labelStyle.borderWidth+"px solid "+n}this.labelStyle.padding&&(o.style.padding=this.labelStyle.padding)}},jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(b){this.label=b,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),i.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var b=this.label(this);this.getElement().innerHTML=b.replace(/\r\n/g,"<br/>")}else{null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))}}})}(),function(){var b=function(d){var c=d._mottle;return c||(c=d._mottle=new Mottle),c};jsPlumb.extend(jsPlumbInstance.prototype,{getEventManager:function(){return b(this)},on:function(){this.getEventManager().on.apply(this,arguments)},off:function(){this.getEventManager().off.apply(this,arguments)}})}.call(this),function(){var b=function(D){this.type="Flowchart",D=D||{},D.stub=null==D.stub?30:D.stub;var C,B=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),A=null==D.midpoint?0.5:D.midpoint,z=[],y=(D.grid,D.alwaysRespectStubs),x=null,w=null,v=null,u=null!=D.cornerRadius?D.cornerRadius:0,t=function(c){return 0>c?-1:0===c?0:1},s=function(G,F,E,o){if(w!=F||v!=E){var n=null==w?o.sx:w,m=null==v?o.sy:v,k=n==F?"v":"h",i=t(F-n),h=t(E-m);w=F,v=E,G.push([n,m,F,E,k,i,h])}},r=function(c){return Math.sqrt(Math.pow(c[0]-c[2],2)+Math.pow(c[1]-c[3],2))},q=function(d){var c=[];return c.push.apply(c,d),c},p=function(O,N,M){for(var L,K,J=0;J<N.length-1;J++){if(L=L||q(N[J]),K=q(N[J+1]),u>0&&L[4]!=K[4]){var I=Math.min(u,r(L),r(K));L[2]-=L[5]*I,L[3]-=L[6]*I,K[0]+=K[5]*I,K[1]+=K[6]*I;var H=L[6]==K[5]&&1==K[5]||L[6]==K[5]&&0===K[5]&&L[5]!=K[6]||L[6]==K[5]&&-1==K[5],G=K[1]>L[3]?1:-1,F=K[0]>L[2]?1:-1,E=G==F,n=E&&H||!E&&!H?K[0]:L[2],m=E&&H||!E&&!H?L[3]:K[1];B.addSegment(O,"Straight",{x1:L[0],y1:L[1],x2:L[2],y2:L[3]}),B.addSegment(O,"Arc",{r:I,x1:L[2],y1:L[3],x2:K[0],y2:K[1],cx:n,cy:m,ac:H})}else{var c=L[2]==L[0]?0:L[2]>L[0]?M.lw/2:-(M.lw/2),P=L[3]==L[1]?0:L[3]>L[1]?M.lw/2:-(M.lw/2);B.addSegment(O,"Straight",{x1:L[0]-c,y1:L[1]-P,x2:L[2]+c,y2:L[3]+P})}L=K}null!=K&&B.addSegment(O,"Straight",{x1:K[0],y1:K[1],x2:K[2],y2:K[3]})};this.setSegments=function(c){x=c},this.isEditable=function(){return !0},this.getOriginalSegments=function(){return x||z},this._compute=function(G,l){if(l.clearEdits&&(x=null),null!=x){return p(this,x,G),void 0}z=[],w=null,v=null,C=null;var i=G.startStubX+(G.endStubX-G.startStubX)*A,h=G.startStubY+(G.endStubY-G.startStubY)*A,g={x:[0,1],y:[1,0]},e=function(){return[G.startStubX,G.startStubY,G.endStubX,G.endStubY]},d={perpendicular:e,orthogonal:e,opposite:function(a){var n=G,m="x"==a?0:1,k={x:function(){return 1==n.so[m]&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||-1==n.so[m]&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return 1==n.so[m]&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||-1==n.so[m]&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}};return !y&&k[a]()?{x:[(G.sx+G.tx)/2,G.startStubY,(G.sx+G.tx)/2,G.endStubY],y:[G.startStubX,(G.sy+G.ty)/2,G.endStubX,(G.sy+G.ty)/2]}[a]:[G.startStubX,G.startStubY,G.endStubX,G.endStubY]}},c={perpendicular:function(V){var U=G,T={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},S={x:[[U.startStubX,U.endStubX],null,[U.endStubX,U.startStubX]],y:[[U.startStubY,U.endStubY],null,[U.endStubY,U.startStubY]]},R={x:[[i,U.startStubY],[i,U.endStubY]],y:[[U.startStubX,h],[U.endStubX,h]]},Q={x:[[U.endStubX,U.startStubY]],y:[[U.startStubX,U.endStubY]]},P={x:[[U.startStubX,U.endStubY],[U.endStubX,U.endStubY]],y:[[U.endStubX,U.startStubY],[U.endStubX,U.endStubY]]},O={x:[[U.startStubX,h],[U.endStubX,h],[U.endStubX,U.endStubY]],y:[[i,U.startStubY],[i,U.endStubY],[U.endStubX,U.endStubY]]},N={x:[U.startStubY,U.endStubY],y:[U.startStubX,U.endStubX]},M=g[V][0],n=g[V][1],m=U.so[M]+1,k=U.to[n]+1,a=-1==U.to[n]&&N[V][1]<N[V][0]||1==U.to[n]&&N[V][1]>N[V][0],Y=S[V][m][0],X=S[V][m][1],W=T[V][m][k];return U.segment==W[3]||U.segment==W[2]&&a?R[V]:U.segment==W[2]&&Y>X?Q[V]:U.segment==W[2]&&X>=Y||U.segment==W[1]&&!a?O[V]:U.segment==W[0]||U.segment==W[1]&&a?P[V]:void 0},orthogonal:function(a,O,N,M,n){var m=G,k={x:-1==m.so[0]?Math.min(O,M):Math.max(O,M),y:-1==m.so[1]?Math.min(O,M):Math.max(O,M)}[a];return{x:[[k,N],[k,n],[M,n]],y:[[N,k],[n,k],[n,M]]}[a]},opposite:function(R,Q,P,O){var N=G,M={x:"y",y:"x"}[R],m={x:"height",y:"width"}[R],k=N["is"+R.toUpperCase()+"GreaterThanStubTimes2"];if(l.sourceEndpoint.elementId==l.targetEndpoint.elementId){var a=P+(1-l.sourceEndpoint.anchor[M])*l.sourceInfo[m]+B.maxStub;return{x:[[Q,a],[O,a]],y:[[a,Q],[a,O]]}[R]}return !k||1==N.so[K]&&Q>O||-1==N.so[K]&&O>Q?{x:[[Q,h],[O,h]],y:[[i,Q],[i,O]]}[R]:1==N.so[K]&&O>Q||-1==N.so[K]&&Q>O?{x:[[i,N.sy],[i,N.ty]],y:[[N.sx,h],[N.tx,h]]}[R]:void 0}},L=d[G.anchorOrientation](G.sourceAxis),K="x"==G.sourceAxis?0:1,J="x"==G.sourceAxis?1:0,I=L[K],H=L[J],F=L[K+2],E=L[J+2];s(z,L[0],L[1],G);var o=c[G.anchorOrientation](G.sourceAxis,I,H,F,E);if(o){for(var f=0;f<o.length;f++){s(z,o[f][0],o[f][1],G)}}s(z,L[2],L[3],G),s(z,G.tx,G.ty,G),p(this,z,G)},this.getPath=function(){for(var g=null,e=null,E=[],o=x||z,n=0;n<o.length;n++){var m=o[n],l=m[4],k="v"==l?3:2;null!=g&&e===l?g[k]=m[k]:(m[0]!=m[2]||m[1]!=m[3])&&(E.push({start:[m[0],m[1]],end:[m[2],m[3]]}),g=m,e=m[4])}return E},this.setPath=function(G){x=[];for(var F=0;F<G.length;F++){var E=G[F].start[0],o=G[F].start[1],n=G[F].end[0],m=G[F].end[1],l=E==n?"v":"h",k=t(n-E),g=t(m-o);x.push([E,o,n,m,l,k,g])}}};jsPlumbUtil.extend(b,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(b,"Flowchart")}(),function(){var e=function(h,g,k,i){return k>=h&&g>=i?1:k>=h&&i>=g?2:h>=k&&i>=g?3:4},d=function(s,r,q,p,o,n,m,l,k){return k>=l?[s,r]:1===q?p[3]<=0&&o[3]>=1?[s+(p[2]<0.5?-1*n:n),r]:p[2]>=1&&o[2]<=0?[s,r+(p[3]<0.5?-1*m:m)]:[s+-1*n,r+-1*m]:2===q?p[3]>=1&&o[3]<=0?[s+(p[2]<0.5?-1*n:n),r]:p[2]>=1&&o[2]<=0?[s,r+(p[3]<0.5?-1*m:m)]:[s+1*n,r+-1*m]:3===q?p[3]>=1&&o[3]<=0?[s+(p[2]<0.5?-1*n:n),r]:p[2]<=0&&o[2]>=1?[s,r+(p[3]<0.5?-1*m:m)]:[s+-1*n,r+-1*m]:4===q?p[3]<=0&&o[3]>=1?[s+(p[2]<0.5?-1*n:n),r]:p[2]<=0&&o[2]>=1?[s,r+(p[3]<0.5?-1*m:m)]:[s+1*n,r+-1*m]:void 0},f=function(p){p=p||{},this.type="StateMachine";var o=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),n=p.curviness||10,m=p.margin||5,l=p.proximityLimit||80,k=p.orientation&&"clockwise"===p.orientation,b=p.loopbackRadius||25,a=p.showLoopback!==!1;this._compute=function(Z,Y){var X=Math.abs(Y.sourcePos[0]-Y.targetPos[0]),W=Math.abs(Y.sourcePos[1]-Y.targetPos[1]);if(Math.min(Y.sourcePos[0],Y.targetPos[0]),Math.min(Y.sourcePos[1],Y.targetPos[1]),a&&Y.sourceEndpoint.elementId===Y.targetEndpoint.elementId){var V=Y.sourcePos[0],U=(Y.sourcePos[0],Y.sourcePos[1]-m),T=(Y.sourcePos[1]-m,V),R=U-b,P=2*b,N=2*b,L=T-b,J=R-b;Z.points[0]=L,Z.points[1]=J,Z.points[2]=P,Z.points[3]=N,o.addSegment(this,"Arc",{loopback:!0,x1:V-L+4,y1:U-J,startAngle:0,endAngle:2*Math.PI,r:b,ac:!k,x2:V-L-4,y2:U-J,cx:T-L,cy:R-J})}else{var H=Y.sourcePos[0]<Y.targetPos[0]?0:X,G=Y.sourcePos[1]<Y.targetPos[1]?0:W,i=Y.sourcePos[0]<Y.targetPos[0]?X:0,h=Y.sourcePos[1]<Y.targetPos[1]?W:0;0===Y.sourcePos[2]&&(H-=m),1===Y.sourcePos[2]&&(H+=m),0===Y.sourcePos[3]&&(G-=m),1===Y.sourcePos[3]&&(G+=m),0===Y.targetPos[2]&&(i-=m),1===Y.targetPos[2]&&(i+=m),0===Y.targetPos[3]&&(h-=m),1===Y.targetPos[3]&&(h+=m);var g=(H+i)/2,S=(G+h)/2,Q=-1*g/S,O=Math.atan(Q),M=(1/0==Q||Q==-1/0?0:Math.abs(n/2*Math.sin(O)),1/0==Q||Q==-1/0?0:Math.abs(n/2*Math.cos(O)),e(H,G,i,h)),K=Math.sqrt(Math.pow(i-H,2)+Math.pow(h-G,2)),I=d(g,S,M,Y.sourcePos,Y.targetPos,n,n,K,l);o.addSegment(this,"Bezier",{x1:i,y1:h,x2:H,y2:G,cp1x:I[0],cp1y:I[1],cp2x:I[0],cp2y:I[1]})}}};jsPlumb.registerConnectorType(f,"StateMachine")}(),function(){var b=function(f){f=f||{};var e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),h=(f.stub||50,f.curviness||150),g=10;this.type="Bezier",this.getCurviness=function(){return h},this._findControlPoint=function(r,q,p,o,n){var m=o.anchor.getOrientation(o),l=n.anchor.getOrientation(n),d=m[0]!=l[0]||m[1]==l[1],c=[];return d?(0===l[0]?c.push(p[0]<q[0]?r[0]+g:r[0]-g):c.push(r[0]+h*l[0]),0===l[1]?c.push(p[1]<q[1]?r[1]+g:r[1]-g):c.push(r[1]+h*m[1])):(0===m[0]?c.push(q[0]<p[0]?r[0]+g:r[0]-g):c.push(r[0]-h*m[0]),0===m[1]?c.push(q[1]<p[1]?r[1]+g:r[1]-g):c.push(r[1]+h*l[1])),c},this._compute=function(y,x){var w=x.sourcePos,v=x.targetPos,u=Math.abs(w[0]-v[0]),t=Math.abs(w[1]-v[1]),s=w[0]<v[0]?u:0,r=w[1]<v[1]?t:0,q=w[0]<v[0]?0:u,p=w[1]<v[1]?0:t,o=this._findControlPoint([s,r],w,v,x.sourceEndpoint,x.targetEndpoint,y.so,y.to),n=this._findControlPoint([q,p],v,w,x.targetEndpoint,x.sourceEndpoint,y.so,y.to);e.addSegment(this,"Bezier",{x1:s,y1:r,x2:q,y2:p,cp1x:o[0],cp1y:o[1],cp2x:n[0],cp2y:n[1]})}};jsPlumbUtil.extend(b,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(b,"Bezier")}(),function(){var X={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},W="stroke-dasharray",V="dashstyle",U="linearGradient",T="radialGradient",S="defs",R="fill",Q="stop",P="stroke",O="stroke-width",N="style",M="none",L="jsplumb_gradient_",K="lineWidth",J={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},I=function(e,d){for(var f in d){e.setAttribute(f,""+d[f])}},H=function(e,d){var f=document.createElementNS(J.svg,e);return d=d||{},d.version="1.1",d.xmlns=J.xhtml,I(f,d),f},G=function(b){return"position:absolute;left:"+b[0]+"px;top:"+b[1]+"px"},F=function(d){for(var c=0;c<d.childNodes.length;c++){(d.childNodes[c].tagName==S||d.childNodes[c].tagName==U||d.childNodes[c].tagName==T)&&d.removeChild(d.childNodes[c])}},E=function(w,s,q,m,i){var h=L+i._jsPlumb.instance.idstamp();F(w);var g;g=q.gradient.offset?H(T,{id:h}):H(U,{id:h,gradientUnits:"userSpaceOnUse"});var f=H(S);w.appendChild(f),f.appendChild(g);for(var e=0;e<q.gradient.stops.length;e++){var d=1==i.segment||2==i.segment?e:q.gradient.stops.length-1-e,Y=jsPlumbUtil.convertStyle(q.gradient.stops[d][1],!0),y=H(Q,{offset:Math.floor(100*q.gradient.stops[e][0])+"%","stop-color":Y});g.appendChild(y)}var x=q.strokeStyle?P:R;s.setAttribute(x,"url(#"+h+")")},D=function(s,n,l,k,i){if(n.setAttribute(R,l.fillStyle?jsPlumbUtil.convertStyle(l.fillStyle,!0):M),n.setAttribute(P,l.strokeStyle?jsPlumbUtil.convertStyle(l.strokeStyle,!0):M),l.gradient?E(s,n,l,k,i):(F(s),n.setAttribute(N,"")),l.lineWidth&&n.setAttribute(O,l.lineWidth),l[V]&&l[K]&&!l[W]){var g=-1==l[V].indexOf(",")?" ":",",c=l[V].split(g),b="";c.forEach(function(d){b+=Math.floor(d*l.lineWidth)+g}),n.setAttribute(W,b)}else{l[W]&&n.setAttribute(W,l[W])}for(var a in X){l[a]&&n.setAttribute(X[a],l[a])}},C=function(e,d,f){e.childNodes.length>f?e.insertBefore(d,e.childNodes[f]):e.appendChild(d)};jsPlumbUtil.svg={node:H,attr:I,pos:G};var B=function(h){var g=h.pointerEventsSpec||"all",m={};jsPlumb.jsPlumbUIComponent.apply(this,h.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var l=h.cssClass+" "+(h.originalArgs[0].cssClass||""),k={style:"",width:0,height:0,"pointer-events":g,position:"absolute"};this.svg=H("svg",k),h.useDivWrapper?(this.canvas=document.createElement("div"),this.canvas.style.position="absolute",jsPlumbUtil.sizeElement(this.canvas,0,0,1,1),this.canvas.className=l):(I(this.svg,{"class":l}),this.canvas=this.svg),h._jsPlumb.appendElement(this.canvas,h.originalArgs[0].parent),h.useDivWrapper&&this.canvas.appendChild(this.svg);var i=[this.canvas];return this.getDisplayElements=function(){return i},this.appendDisplayElement=function(b){i.push(b)},this.paint=function(a,q,p){if(null!=a){var o,n=[this.x,this.y],c=[this.w,this.h];null!=p&&(p.xmin<0&&(n[0]+=p.xmin),p.ymin<0&&(n[1]+=p.ymin),c[0]=p.xmax+(p.xmin<0?-p.xmin:0),c[1]=p.ymax+(p.ymin<0?-p.ymin:0)),h.useDivWrapper?(jsPlumbUtil.sizeElement(this.canvas,n[0],n[1],c[0],c[1]),n[0]=0,n[1]=0,o=G([0,0])):o=G([n[0],n[1]]),m.paint.apply(this,arguments),I(this.svg,{style:o,width:c[0],height:c[1]})}},{renderer:m}};jsPlumbUtil.extend(B,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null},setVisible:function(b){this.canvas&&(this.canvas.style.display=b?"block":"none")}}),jsPlumb.ConnectorRenderers.svg=function(e){var d=this,f=B.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]);f.renderer.paint=function(x,w,v){var u=d.getSegments(),t="",s=[0,0];if(v.xmin<0&&(s[0]=-v.xmin),v.ymin<0&&(s[1]=-v.ymin),u.length>0){for(var r=0;r<u.length;r++){t+=jsPlumb.Segments.svg.SegmentRenderer.getPath(u[r]),t+=" "}var q={d:t,transform:"translate("+s[0]+","+s[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},p=null,o=[d.x,d.y,d.w,d.h];if(x.outlineColor){var b=x.outlineWidth||1,a=x.lineWidth+2*b;p=jsPlumb.extend({},x),delete p.gradient,p.strokeStyle=jsPlumbUtil.convertStyle(x.outlineColor),p.lineWidth=a,null==d.bgPath?(d.bgPath=H("path",q),C(d.svg,d.bgPath,0)):I(d.bgPath,q),D(d.svg,d.bgPath,p,o,d)}null==d.path?(d.path=H("path",q),C(d.svg,d.path,x.outlineColor?1:0)):I(d.path,q),D(d.svg,d.path,x,o,d)}}},jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,B),jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(b){return{Straight:function(){var a=b.getCoordinates();return"M "+a.x1+" "+a.y1+" L "+a.x2+" "+a.y2},Bezier:function(){var a=b.params;return"M "+a.x1+" "+a.y1+" C "+a.cp1x+" "+a.cp1y+" "+a.cp2x+" "+a.cp2y+" "+a.x2+" "+a.y2},Arc:function(){var a=b.params,f=b.sweep>Math.PI?1:0,e=b.anticlockwise?0:1;return"M"+b.x1+" "+b.y1+" A "+b.radius+" "+a.r+" 0 "+f+","+e+" "+b.x2+" "+b.y2}}[b.type]()}}};var A=window.SvgEndpoint=function(d){var c=B.apply(this,[{cssClass:d._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:d._jsPlumb}]);c.renderer.paint=function(f){var e=jsPlumb.extend({},f);e.outlineColor&&(e.strokeWidth=e.outlineWidth,e.strokeStyle=jsPlumbUtil.convertStyle(e.outlineColor,!0)),null==this.node?(this.node=this.makeNode(e),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node),D(this.svg,this.node,e,[this.x,this.y,this.w,this.h],this),G(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(A,B),jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),A.apply(this,arguments),this.makeNode=function(){return H("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(b){I(b,{cx:this.w/2,cy:this.h/2,r:this.radius})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,A]),jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),A.apply(this,arguments),this.makeNode=function(){return H("rect",{width:this.w,height:this.h})},this.updateNode=function(b){I(b,{width:this.w,height:this.h})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,A]),jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var z=function(e,d){e.apply(this,d),jsPlumb.jsPlumbUIComponent.apply(this,d),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(b,h){if(b.component.svg&&h){null==this.path&&(this.path=H("path",{"pointer-events":"all"}),b.component.svg.appendChild(this.path),this.canvas=b.component.svg);var g=d&&1==d.length?d[0].cssClass||"":"",c=[0,0];h.xmin<0&&(c[0]=-h.xmin),h.ymin<0&&(c[1]=-h.ymin),I(this.path,{d:f(b.d),"class":g,stroke:b.strokeStyle?b.strokeStyle:null,fill:b.fillStyle?b.fillStyle:null,transform:"translate("+c[0]+","+c[1]+")"})}};var f=function(b){return"M"+b.hxy.x+","+b.hxy.y+" L"+b.tail[0].x+","+b.tail[0].y+" L"+b.cxy.x+","+b.cxy.y+" L"+b.tail[1].x+","+b.tail[1].y+" L"+b.hxy.x+","+b.hxy.y}};jsPlumbUtil.extend(z,[jsPlumb.jsPlumbUIComponent,jsPlumb.Overlays.AbstractOverlay],{cleanup:function(){null!=this.path&&this._jsPlumb.instance.removeElement(this.path)},setVisible:function(b){null!=this.path&&(this.path.style.display=b?"block":"none")}}),jsPlumb.Overlays.svg.Arrow=function(){z.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,z]),jsPlumb.Overlays.svg.PlainArrow=function(){z.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,z]),jsPlumb.Overlays.svg.Diamond=function(){z.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,z]),jsPlumb.Overlays.svg.GuideLines=function(){var g,f,k=null,i=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(c,b){null==k&&(k=H("path"),c.connector.svg.appendChild(k),i.attachListeners(k,c.connector),i.attachListeners(k,i),g=H("path"),c.connector.svg.appendChild(g),i.attachListeners(g,c.connector),i.attachListeners(g,i),f=H("path"),c.connector.svg.appendChild(f),i.attachListeners(f,c.connector),i.attachListeners(f,i));var a=[0,0];b.xmin<0&&(a[0]=-b.xmin),b.ymin<0&&(a[1]=-b.ymin),I(k,{d:h(c.head,c.tail),stroke:"red",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),I(g,{d:h(c.tailLine[0],c.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),I(f,{d:h(c.headLine[0],c.headLine[1]),stroke:"green",fill:null,transform:"translate("+a[0]+","+a[1]+")"})};var h=function(d,c){return"M "+d.x+","+d.y+" L"+c.x+","+c.y}},jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)}(),function(){var F={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},E=null;if(document.createStyleSheet&&document.namespaces){var D=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],C="behavior:url(#default#VML);position:absolute;";E=document.createStyleSheet();for(var B=0;B<D.length;B++){E.addRule(D[B],C)}document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var A=1000,z=function(e,d){for(var f in d){e[f]=d[f]}},y=function(i,g,o,n,m,l){o=o||{};var k=document.createElement("jsplumb:"+i);return l?m.appendElement(k,n):n.appendChild(k),k.className=(o["class"]?o["class"]+" ":"")+"jsplumb_vml",x(k,g),z(k,o),k},x=function(e,d,f){e.style.left=d[0]+"px",e.style.top=d[1]+"px",e.style.width=d[2]+"px",e.style.height=d[3]+"px",e.style.position="absolute",f&&(e.style.zIndex=f)},w=jsPlumb.vml.convertValue=function(b){return Math.floor(b*A)},v=function(f,e,h,g){"transparent"===e?g.setOpacity(h,"0.0"):g.setOpacity(h,"1.0")},u=function(L,K,J,I){var H={};if(K.strokeStyle){H.stroked="true";var G=jsPlumbUtil.convertStyle(K.strokeStyle,!0);H.strokecolor=G,v(H,G,"stroke",J),H.strokeweight=K.lineWidth+"px"}else{H.stroked="false"}if(K.fillStyle){H.filled="true";var p=jsPlumbUtil.convertStyle(K.fillStyle,!0);H.fillcolor=p,v(H,p,"fill",J)}else{H.filled="false"}if(K.dashstyle){null==J.strokeNode?J.strokeNode=y("stroke",[0,0,0,0],{dashstyle:K.dashstyle},L,I):J.strokeNode.dashstyle=K.dashstyle}else{if(K["stroke-dasharray"]&&K.lineWidth){for(var o=-1==K["stroke-dasharray"].indexOf(",")?" ":",",k=K["stroke-dasharray"].split(o),h="",g=0;g<k.length;g++){h+=Math.floor(k[g]/K.lineWidth)+o}null==J.strokeNode?J.strokeNode=y("stroke",[0,0,0,0],{dashstyle:h},L,I):J.strokeNode.dashstyle=h}}z(L,H)},t=function(){var d=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(a){d.opacityNodes.stroke=y("stroke",[0,0,1,1],{opacity:"0.0"},a,d._jsPlumb.instance),d.opacityNodes.fill=y("fill",[0,0,1,1],{opacity:"0.0"},a,d._jsPlumb.instance)},this.setOpacity=function(a,f){var e=d.opacityNodes[a];e&&(e.opacity=""+f)};var c=[];this.getDisplayElements=function(){return c},this.appendDisplayElement=function(b,a){a||d.canvas.parentNode.appendChild(b),c.push(b)}};jsPlumbUtil.extend(t,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&this.bgCanvas.parentNode.removeChild(this.bgCanvas),this.canvas&&this.canvas.parentNode.removeChild(this.canvas)}});var s=jsPlumb.ConnectorRenderers.vml=function(a,f){this.strokeNode=null,this.canvas=null,t.apply(this,arguments);var e=this._jsPlumb.instance.connectorClass+(a.cssClass?" "+a.cssClass:"");this.paint=function(H){if(null!==H){this.w=Math.max(this.w,1),this.h=Math.max(this.h,1);for(var G=this.getSegments(),l={path:""},i=[this.x,this.y,this.w,this.h],h=0;h<G.length;h++){l.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(G[h]),l.path+=" "}if(H.outlineColor){var g=H.outlineWidth||1,d=H.lineWidth+2*g,c={strokeStyle:jsPlumbUtil.convertStyle(H.outlineColor),lineWidth:d};for(var b in F){c[b]=H[b]}null==this.bgCanvas?(l["class"]=e,l.coordsize=i[2]*A+","+i[3]*A,this.bgCanvas=y("shape",i,l,a.parent,this._jsPlumb.instance,!0),x(this.bgCanvas,i),this.appendDisplayElement(this.bgCanvas,!0),this.initOpacityNodes(this.bgCanvas,["stroke"]),this.bgCanvas._jsPlumb=f):(l.coordsize=i[2]*A+","+i[3]*A,x(this.bgCanvas,i),z(this.bgCanvas,l)),u(this.bgCanvas,c,this)}null==this.canvas?(l["class"]=e,l.coordsize=i[2]*A+","+i[3]*A,this.canvas=y("shape",i,l,a.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(this.canvas,["stroke"]),this.canvas._jsPlumb=f):(l.coordsize=i[2]*A+","+i[3]*A,x(this.canvas,i),z(this.canvas,l)),u(this.canvas,H,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(s,t,{setVisible:function(b){this.canvas&&(this.canvas.style.display=b?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=b?"block":"none")}});var r=window.VmlEndpoint=function(b){t.apply(this,arguments),this._jsPlumb.vml=null,this.canvas=document.createElement("div"),this.canvas.style.position="absolute",this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(b.cssClass?" "+b.cssClass:""),b._jsPlumb.appendElement(this.canvas,b.parent),this.paint=function(f,e){var h={},g=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),null==this._jsPlumb.vml?(h["class"]=this._jsPlumb.clazz,g=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],h,e,this.canvas,this._jsPlumb.instance),this.appendDisplayElement(g,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(g,["fill"])):(x(g,[0,0,this.w,this.h]),z(g,h)),u(g,f,this)}};jsPlumbUtil.extend(r,t),jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(b){return{Straight:function(d){var c=d.params;return"m"+w(c.x1)+","+w(c.y1)+" l"+w(c.x2)+","+w(c.y2)+" e"},Bezier:function(d){var c=d.params;return"m"+w(c.x1)+","+w(c.y1)+" c"+w(c.cp1x)+","+w(c.cp1y)+","+w(c.cp2x)+","+w(c.cp2y)+","+w(c.x2)+","+w(c.y2)+" e"},Arc:function(i){var h=i.params,o=Math.min(h.x1,h.x2),n=(Math.max(h.x1,h.x2),Math.min(h.y1,h.y2)),m=(Math.max(h.y1,h.y2),i.anticlockwise?1:0),l=i.anticlockwise?"at ":"wa ",k=function(){if(h.loopback){return"0,0,"+w(2*h.r)+","+w(2*h.r)}var a=[null,[function(){return[o,n]},function(){return[o-h.r,n-h.r]}],[function(){return[o-h.r,n]},function(){return[o,n-h.r]}],[function(){return[o-h.r,n-h.r]},function(){return[o,n]}],[function(){return[o,n-h.r]},function(){return[o-h.r,n]}]][i.segment][m]();return w(a[0])+","+w(a[1])+","+w(a[0]+2*h.r)+","+w(a[1]+2*h.r)};return l+" "+k()+","+w(h.x1)+","+w(h.y1)+","+w(h.x2)+","+w(h.y2)+" e"}}[b.type](b)}}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),r.apply(this,arguments),this.getVml=function(g,f,k,i,h){return y("oval",g,f,i,h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,r),jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),r.apply(this,arguments),this.getVml=function(g,f,k,i,h){return y("rect",g,f,i,h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,r),jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var q=function(f,e){f.apply(this,e),t.apply(this,e);var h=this;this.canvas=null,this.isAppendedAtTopLevel=!0;var g=function(b){return"m "+w(b.hxy.x)+","+w(b.hxy.y)+" l "+w(b.tail[0].x)+","+w(b.tail[0].y)+" "+w(b.cxy.x)+","+w(b.cxy.y)+" "+w(b.tail[1].x)+","+w(b.tail[1].y)+" x e"};this.paint=function(M,L){if(M.component.canvas&&L){var K={},J=M.d,I=M.component;M.strokeStyle&&(K.stroked="true",K.strokecolor=jsPlumbUtil.convertStyle(M.strokeStyle,!0)),M.lineWidth&&(K.strokeweight=M.lineWidth+"px"),M.fillStyle&&(K.filled="true",K.fillcolor=M.fillStyle);var H=Math.min(J.hxy.x,J.tail[0].x,J.tail[1].x,J.cxy.x),G=Math.min(J.hxy.y,J.tail[0].y,J.tail[1].y,J.cxy.y),i=Math.max(J.hxy.x,J.tail[0].x,J.tail[1].x,J.cxy.x),d=Math.max(J.hxy.y,J.tail[0].y,J.tail[1].y,J.cxy.y),c=Math.abs(i-H),b=Math.abs(d-G),P=[H,G,c,b];if(K.path=g(J),K.coordsize=I.w*A+","+I.h*A,P[0]=I.x,P[1]=I.y,P[2]=I.w,P[3]=I.h,null==h.canvas){var O=I._jsPlumb.overlayClass||"",N=e&&1==e.length?e[0].cssClass||"":"";K["class"]=N+" "+O,h.canvas=y("shape",P,K,I.canvas.parentNode,I._jsPlumb.instance,!0),I.appendDisplayElement(h.canvas,!0)}else{x(h.canvas,P),z(h.canvas,K)}}},this.cleanup=function(){null!=this.canvas&&this._jsPlumb.instance.removeElement(this.canvas)}};jsPlumbUtil.extend(q,[t,jsPlumb.Overlays.AbstractOverlay],{setVisible:function(b){this.canvas.style.display=b?"block":"none"}}),jsPlumb.Overlays.vml.Arrow=function(){q.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,q]),jsPlumb.Overlays.vml.PlainArrow=function(){q.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,q]),jsPlumb.Overlays.vml.Diamond=function(){q.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,q])}(),function(d){var c=function(a){return"string"==typeof a?d("#"+a):d(a)};d.extend(jsPlumbInstance.prototype,{getDOMElement:function(b){return null==b?null:"string"==typeof b?document.getElementById(b):b.context||null!=b.length?b[0]:b},getElementObject:c,removeElement:function(b){c(b).remove()},doAnimate:function(f,e,g){f.animate(e,g)},getSelector:function(b,a){return 2==arguments.length?c(b).find(a):d(b)},destroyDraggable:function(a){d(a).data("draggable")&&d(a).draggable("destroy")},destroyDroppable:function(a){d(a).data("droppable")&&d(a).droppable("destroy")},initDraggable:function(a,f,e){f=f||{},a=d(a),f.start=jsPlumbUtil.wrap(f.start,function(){d("body").addClass(this.dragSelectClass)},!1),f.stop=jsPlumbUtil.wrap(f.stop,function(){d("body").removeClass(this.dragSelectClass)}),f.doNotRemoveHelper||(f.helper=null),"internal"==e&&(f.scope=f.scope||jsPlumb.Defaults.Scope),a.draggable(f)},initDroppable:function(a,e){e.scope=e.scope||jsPlumb.Defaults.Scope,d(a).droppable(e)},isAlreadyDraggable:function(a){return d(a).hasClass("ui-draggable")},isDragSupported:function(a){return d(a).draggable},isDropSupported:function(a){return d(a).droppable},getDragObject:function(b){return b[1].helper||b[1].draggable},getDragScope:function(a){return d(a).draggable("option","scope")},getDropEvent:function(b){return b[0]},getDropScope:function(a){return d(a).droppable("option","scope")},getUIPosition:function(h,g,m){var l;if(g=g||1,1==h.length){l={left:h[0].pageX,top:h[0].pageY}}else{var k=h[1],i=k.position;l=i||k.absolutePosition,m||(k.position.left/=g,k.position.top/=g)}return{left:l.left,top:l.top}},isDragFilterSupported:function(){return !0},setDragFilter:function(a,e){jsPlumb.isAlreadyDraggable(a)&&d(a).draggable("option","cancel",e)},setElementDraggable:function(a,e){d(a).draggable("option","disabled",!e)},setDragScope:function(a,e){d(a).draggable("option","scope",e)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},animEvents:{step:"step",complete:"complete"},getOriginalEvent:function(b){return b.originalEvent||b},trigger:function(b,h,g){var f=jQuery._data(c(b)[0],"handle");f(g)}}),d(document).ready(jsPlumb.init)}(jQuery);